import{L as S,u as F,S as N}from"./lists.552cedc5.js";import{j as o,a as p,b as G,D as T,E as L,v as R,I as M}from"./index.4f01769a.js";import{aX as $,aK as x,aD as B}from"./vendor.079a595c.js";import{f as E,B as P,F as H,a as q}from"./filterConfig.3d04c02f.js";import{G as z}from"./GlowToggle.429782fa.js";import{g as K}from"./index.78736df0.js";import{u as O,G as Q}from"./Gallery.035c95f4.js";import{u as w}from"./useToggleState.e402c4c6.js";import{M as V}from"./ModelIcon.7811c07e.js";import{B as C}from"./Box.ca96f500.js";import{a as X,b as Y}from"./DialogTitle.d323bddc.js";import{I as J}from"./Close.75f068cc.js";import"./Popover.66b0e879.js";import"./ButtonBase.82b3d34a.js";import"./MenuItem.463b8eb1.js";const h={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh","& svg":{color:"rgba(16, 16, 16, 0.8)"}},top:{display:"flex",flexWrap:"wrap",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)"},searchFilter:{marginTop:"0.2rem",display:"flex",flexDirection:"column",width:"100%",minWidth:"20rem",alignItems:"center",justifyContent:"center","& .MuiTextField-root":{justifyContent:"center"}},search:{display:"flex",width:"100%",justifyContent:"center"},title:{padding:"0.5rem 1rem",textAlign:"center",flexGrow:.1,margin:"auto"},content:{padding:"0.3rem",textAlign:"center",minHeight:"60vh"}},I=[{value:"weapon",label:"Weapon",icon:"img/appIcon/weapon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"},{value:"extra",label:"Extra"}]},{value:"chara",label:"Adventurer",icon:"img/appIcon/chara.png",options:[{value:"regular",label:"Regular"},{value:"allies",label:"Allies"},{value:"enemies",label:"Enemies"}]},{value:"dragon",label:"Dragon",icon:"img/appIcon/dragon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"}]},{value:"boss",label:"Boss",icon:"img/appIcon/boss.png",options:[{value:"archdemon",label:"Archdemon",icon:"img/appIcon/archdemon.png"},{value:"agito",label:"Agito",icon:"img/appIcon/agito.png"},{value:"raid",label:"Raid",icon:"img/appIcon/raid.png"},{value:"void",label:"Void",icon:"img/appIcon/void.png"},{value:"others",label:"Others"}]}],U=e=>{let t=I;const i=[];return e.forEach(c=>{const a=t[c],l=a==null?void 0:a.value;l!==void 0&&(i.push(l),t=a.options)}),i.join("-")},Z={Left:"\u21D0",Right:"\u21D2"},D=({side:e,onClick:t})=>o("div",{className:"WeaponButton-addBtn","data-side":e,onClick:t,children:Z[e]});const _=e=>e.stopPropagation();function ee({id:e,name:t,noIcon:i,onClick:c}){const[a,l]=w(!1),[u,m]=w(!1),g=!i&&o(V,{modelId:e,className:"WeaponButton-icon"}),n=a&&p("div",{className:"WeaponButton-grip",onClick:_,children:[o("input",{type:"checkbox",id:`grip-${e}`,checked:u,onChange:m}),o("label",{htmlFor:`grip-${e}`,children:"Reverse Grip"})]}),f=d=>{d.stopPropagation();const{side:s}=d.currentTarget.dataset;c({side:s,id:e,name:t,reverse:u})};return p("div",{className:"WeaponButton",children:[g,a?p("div",{className:"WeaponButton-add",onClick:l,children:[n,p("div",{className:"WeaponButton-addBtnGroup",children:[o(D,{side:"Left",onClick:f}),o("div",{children:"ADD"}),o(D,{side:"Right",onClick:f})]})]}):o("div",{className:"WeaponButton-name",onClick:l,children:t})]})}const oe=[];function ae({content:e,searchQuery:t,searchAll:i,filter:c=oe}){var d;const a=(d=O(s=>s[e]))!=null?d:[],[l,u]=x([]),[m,g]=x(!1),{activeModel:n}=G();B(()=>u(a),[e]),B(()=>{g(!0);async function s(){if(i)return t?await T(t):a;const r=await L(a,t);return await E(r,c)}setTimeout(async()=>{const r=await s();u(r),g(!1)})},[t,c,i]);const f=async({side:s,id:r,name:b,reverse:A})=>{var y;const j=`jWeapon${s[0]}`;if(!(n==null?void 0:n.bones.list.includes(j)))return;const v=await R.loadDLModel(r);v.userData.name=b,A&&(v.rotation.y=Math.PI),(y=n.attachment[j])==null||y.forEach(k=>k.dispose()),n.attach(v,j),v.outline.code=n.outline.code,v.material.code=n.material.code};return a.length&&!m?o(Q,{list:l,component:ee,onClick:f}):o(S,{})}var te=$(ae);const W=[];function xe(){const{indices:e,setIndex:t,showFilter:i,toggleFilter:c,searchAll:a,toggleSearchAll:l}=M(),u=!!indexedDB,[m,g]=x(""),n=F(m,500),[f,d]=x(W),s=U(e),r=K(s);B(()=>d(W),[i,e]),B(()=>{g(""),a&&l()},[e]);const b=e.join();return p(C,{className:"AddWeapon",sx:h.root,children:[p(C,{sx:h.top,children:[o(X,{sx:h.title,children:"Add Weapon"}),o(P,{options:I,selectedIndices:e,setIndex:t}),p(C,{sx:h.searchFilter,children:[p(C,{sx:h.search,children:[u&&o(z,{type:"text",value:"All",checked:a,onClick:l}),o(N,{query:m,onChange:g},b),r&&!a&&o(J,{onClick:c,size:"large",children:o(H,{})})]}),!a&&i&&r&&o(q,{config:r,onChange:d},b)]})]}),o(Y,{sx:h.content,children:o(te,{searchQuery:n,filter:f,content:s,searchAll:a})})]})}export{xe as default};
