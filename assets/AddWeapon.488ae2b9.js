import{L as S,u as F,S as N}from"./lists.cc736e19.js";import{j as o,a as d,H as G,I as T,v as L,b as M,J as R}from"./index.ada83c8b.js";import{ao as $,ab as C,a4 as y}from"./vendor.2ce87b54.js";import{f as E,B as H,F as P,a as q}from"./filterConfig.bccd6b2d.js";import{G as z}from"./GlowToggle.fb35ea9e.js";import{g as J}from"./index.e1b8cc6f.js";import{u as O,G as Q}from"./Gallery.406dd1d5.js";import{u as I}from"./useToggleState.35b79c22.js";import{M as V}from"./ModelIcon.a70fc4e8.js";import{B as j}from"./Box.980abc38.js";import{a as Y,b as K}from"./DialogTitle.c7c537d5.js";import{I as U}from"./Close.83137ce6.js";const f={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh","& svg":{color:"rgba(16, 16, 16, 0.8)"}},top:{display:"flex",flexWrap:"wrap",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)"},searchFilter:{marginTop:"0.2rem",display:"flex",flexDirection:"column",width:"100%",minWidth:"20rem",alignItems:"center",justifyContent:"center","& .MuiTextField-root":{justifyContent:"center"}},search:{display:"flex",width:"100%",justifyContent:"center"},title:{padding:"0.5rem 1rem",textAlign:"center",flexGrow:.1,margin:"auto"},content:{padding:"0.3rem",textAlign:"center",minHeight:"60vh"}},A=[{value:"weapon",label:"Weapon",icon:"img/appIcon/weapon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"},{value:"extra",label:"Extra"}]},{value:"chara",label:"Adventurer",icon:"img/appIcon/chara.png",options:[{value:"regular",label:"Regular"},{value:"allies",label:"Allies"},{value:"enemies",label:"Enemies"}]},{value:"dragon",label:"Dragon",icon:"img/appIcon/dragon.png",options:[{value:"regular",label:"Regular"},{value:"special",label:"Special"}]},{value:"boss",label:"Boss",icon:"img/appIcon/boss.png",options:[{value:"archdemon",label:"Archdemon",icon:"img/appIcon/archdemon.png"},{value:"agito",label:"Agito",icon:"img/appIcon/agito.png"},{value:"raid",label:"Raid",icon:"img/appIcon/raid.png"},{value:"void",label:"Void",icon:"img/appIcon/void.png"},{value:"others",label:"Others"}]}],X=e=>{let t=A;const a=[];return e.forEach(c=>{const n=t[c],i=n==null?void 0:n.value;i!==void 0&&(a.push(i),t=n.options)}),a.join("-")},Z={Left:"\u21D0",Right:"\u21D2"},W=({side:e,onClick:t})=>o("div",{className:"WeaponButton-addBtn","data-side":e,onClick:t,children:Z[e]});const _=e=>e.stopPropagation();function ee({id:e,name:t,noIcon:a,onClick:c}){const[n,i]=I(!1),[l,p]=I(!1),b=!a&&o(V,{modelId:e,className:"WeaponButton-icon"}),u=n&&d("div",{className:"WeaponButton-grip",onClick:_,children:[o("input",{type:"checkbox",id:`grip-${e}`,checked:l,onChange:p}),o("label",{htmlFor:`grip-${e}`,children:"Reverse Grip"})]}),g=m=>{m.stopPropagation();const{side:s}=m.currentTarget.dataset;c({side:s,id:e,name:t,reverse:l})};return d("div",{className:"WeaponButton",children:[b,n?d("div",{className:"WeaponButton-add",onClick:i,children:[u,d("div",{className:"WeaponButton-addBtnGroup",children:[o(W,{side:"Left",onClick:g}),o("div",{children:"ADD"}),o(W,{side:"Right",onClick:g})]})]}):o("div",{className:"WeaponButton-name",onClick:i,children:t})]})}const oe=[];function ae({target:e,content:t,searchQuery:a,searchAll:c,filter:n=oe}){var m;const i=(m=O(s=>s[t]))!=null?m:[],[l,p]=C([]),[b,u]=C(!1);y(()=>p(i),[t]),y(()=>{u(!0);async function s(){if(c)return a?await G(a):i;const r=await T(i,a);return await E(r,n)}setTimeout(async()=>{const r=await s();p(r),u(!1)})},[a,n,c]);const g=async({side:s,id:r,name:B,reverse:v})=>{var w;const h=`jWeapon${s[0]}`;if(!(e==null?void 0:e.bones.list.includes(h)))return;const x=await L.loadDLModel(r);x.userData.name=B,v&&(x.rotation.y=Math.PI),(w=e.attachment[h])==null||w.forEach(k=>k.dispose()),e.attach(x,h),x.outline.code=e.outline.code,x.material.code=e.material.code};return i.length&&!b?o(Q,{list:l,component:ee,onClick:g}):o(S,{})}var ne=$(ae);const D=[];function fe({target:e}){const{activeModel:t}=M();e!=null||(e=t);const{indices:a,setIndex:c,showFilter:n,toggleFilter:i,searchAll:l,toggleSearchAll:p}=R(),b=!!indexedDB,[u,g]=C(""),m=F(u,500),[s,r]=C(D),B=X(a),v=J(B);y(()=>r(D),[n,a]),y(()=>{g(""),l&&p()},[a]);const h=a.join();return d(j,{className:"AddWeapon",sx:f.root,children:[d(j,{sx:f.top,children:[o(Y,{sx:f.title,children:"Add Weapon"}),o(H,{options:A,selectedIndices:a,setIndex:c}),d(j,{sx:f.searchFilter,children:[d(j,{sx:f.search,children:[b&&o(z,{type:"text",value:"All",checked:l,onClick:p}),o(N,{query:u,onChange:g},h),v&&!l&&o(U,{onClick:i,size:"large",children:o(P,{})})]}),!l&&n&&v&&o(q,{config:v,onChange:r},h)]})]}),o(K,{sx:f.content,children:o(ne,{target:e,searchQuery:m,filter:s,content:B,searchAll:l})})]})}export{fe as A};
