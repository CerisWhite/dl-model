var V=Object.defineProperty,z=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var E=(e,n,t)=>n in e?V(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,m=(e,n)=>{for(var t in n||(n={}))P.call(n,t)&&E(e,t,n[t]);if(B)for(var t of B(n))W.call(n,t)&&E(e,t,n[t]);return e},p=(e,n)=>z(e,K(n));var q=(e,n)=>{var t={};for(var o in e)P.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&B)for(var o of B(e))n.indexOf(o)<0&&W.call(e,o)&&(t[o]=e[o]);return t};import{F as _,ab as b,a4 as C}from"./vendor.2ce87b54.js";import{L as Q,W as F,u as Y,S as X}from"./lists.428e4cbd.js";import{S as $}from"./Stretcher.1d2e850e.js";import{a as J,b as Z,T as ee}from"./TabBar.82845c79.js";import{j as a,a as d,h as g,F as f,n as ne,K as ae,L as te,v as oe}from"./index.989ee1c4.js";import{B as y}from"./Button.1ecc8e12.js";import{h as ie,M as ce}from"./ModelIcon.0a56a9bf.js";import{G as T,u as v}from"./Gallery.b2185916.js";import{s as se,g as le}from"./aniFunction.cccac812.js";import{S as M}from"./Selector.e9155a60.js";import{u as re}from"./useKey.4c30960f.js";import{U as ue,f as de}from"./file2dataURL.e4bd54f6.js";import{u as me}from"./useToggleState.35b79c22.js";import{c as L}from"./Popover.ef33bdba.js";import{B as O}from"./Box.332eb66f.js";import{a as pe,b as he}from"./DialogTitle.d8924aa0.js";import"./Close.eec93a03.js";import"./ButtonBase.c63a6f2a.js";import"./GlowToggle.a765dce9.js";const ge=e=>e&&new Promise(n=>{new _().load(e,n)});var ve=L(a("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Ae=L(a("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit"),fe=L(a("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");function Se(l){var u=l,{icon:e="",subIcon:n="",title:t,subtitle:o="",onClick:c}=u,i=q(u,["icon","subIcon","title","subtitle","onClick"]);const s=e&&d("div",{className:"IconButton-icons",children:[a("img",{className:"IconButton-mainIcon",src:e,alt:t,loading:"lazy"}),n&&a("img",{className:"IconButton-subIcon",src:n,alt:n,loading:"lazy"})]}),r=d("div",{className:"IconButton-description",children:[o&&a("h5",{className:"IconButton-subtitle",children:o}),a("h3",{className:"IconButton-title",children:t})]});return a(y,p(m({variant:"outlined",className:"IconButton",onClick:c,startIcon:s},i),{children:r}))}function D({icon:e,user:n,name:t,fullName:o=t,subtitle:c="",code:i,onClick:l}){const u=ie(n)?`img/icon/${n}.png`:"",s=e?`img/aniIcon/${e}.png`:u;return a(Se,{icon:s,subIcon:e&&u,title:t,subtitle:c,onClick:l,"data-code":i,"data-name":o})}function ye({icon:e,user:n,code:t,fullName:o,onClick:c}){return a(D,{icon:e,user:n,name:o,code:t,onClick:c})}function be({query:e,onSelect:n}){const[t,o]=b([]),[c,i]=b(!0);return C(()=>{i(!0),setTimeout(async()=>{const l=await se(e);o(l),i(!1)})},[e]),d("div",{className:"AniSearchResult",children:[a($,{}),c?a(Q,{}):a(T,{list:t,component:ye,onClick:n})]})}const Ce=[{label:"Home Screen",name:"home"},{label:"In Quest",name:"quest"},{label:"Weapon Specific",name:"weapon"},{label:"Generic Skills",name:"genericSkill"},{label:"Unique Skills",name:"uniqueSkill"},{label:"Unique Combo",name:"uniqueCombo"},{label:"Unique Force Strike",name:"uniqueFS"},{label:"Unique Victory",name:"uniqueVictory"},{label:"Other Unique",name:"uniqueOther"},{label:"Misc",name:"misc"}];function R({tabs:e,value:n,onChange:t}){return a(J,{variant:"scrollable",orientation:"vertical",className:"VerticalTabs",value:n,onChange:(c,i)=>t(i),children:e.map(({label:c,name:i})=>a(Z,{label:c!=null?c:i,value:i},i))})}const Ne={minHeight:"3rem"};function j(i){var l=i,{name:e,code:n,onClick:t,fullName:o}=l,c=q(l,["name","code","onClick","fullName"]);return a(y,p(m({className:"AniSelect-Btn",variant:"contained","data-code":n,"data-name":o!=null?o:e,onClick:t,sx:Ne},c),{children:e}))}const ke=["Male","Female"];function Be({value:e,onClick:n}){return a(M,{type:"text",options:ke,value:e,onClick:n})}function qe({onSelect:e}){const{gender:n,setGender:t}=g(c=>c.advAni.home),o=v(c=>c["ani-home"]);return d("div",{className:"HomeAni",children:[a("h3",{className:"HomeAni-groupTitle",children:"Common Animation"}),a("div",{className:"AniSelect-simpleBtns",children:o.common.map(({name:c,code:i})=>a(j,{name:c,code:i,onClick:e,className:"AniSelect-Btn"},c))}),a("hr",{}),d("div",{className:"HomeAni-groupTitle",children:[a("h3",{children:"Gender Specific"}),a(Be,{value:n,onClick:t})]}),a("div",{className:"AniSelect-simpleBtns",children:o[n].map(({name:c,code:i})=>a(j,{name:c,code:i,fullName:`${n} ${c}`,onClick:e,className:"AniSelect-Btn"},c))})]})}function S({list:e,onClick:n}){return a(T,{list:e,component:j,onClick:n})}function $e({onSelect:e}){const n=v(t=>t["ani-quest"]);return a(S,{list:n,onClick:e})}const I=["Long","Close","Rapid"],xe=I.map(e=>`img/appIcon/gun_${e}.png`);function Ue({value:e,onClick:n}){return a(M,{type:"icon",options:I,icons:xe,labels:I,value:e,onClick:n})}const Te=F.map(e=>`img/appIcon/weapon_${e}.png`);function x({value:e,onClick:n}){return a(M,{type:"icon",options:F,icons:Te,value:e,onClick:n})}const Me={Long:"Long Range",Close:"Close Range",Rapid:"Rapid Fire"};function Le({onSelect:e}){const{type:n,setType:t,gunMode:o,setGunMode:c}=g(r=>r.advAni.weapon),i=v(r=>r["ani-weapon"]),l=v(r=>r["ani-gun"]),u=i[n].map(r=>p(m({},r),{fullName:`${n} ${r.name}`})),s=l[o].map(r=>p(m({},r),{fullName:`${Me[o]} Manacaster ${r.name}`}));return d("div",{className:"WeaponAni",children:[a(x,{value:n,onClick:t}),a(S,{list:u,onClick:e}),n==="Manacaster"&&d(f,{children:[a(Ue,{value:o,onClick:c}),a(S,{list:s,onClick:e})]})]})}function je({onSelect:e}){const{type:n,setType:t}=g(i=>i.advAni.genericSkill),c=v(i=>i["ani-genericSkill"])[n].map(i=>p(m({},i),{fullName:`${n} ${i.name}`}));return d("div",{className:"GenericSkills",children:[a(x,{value:n,onClick:t}),a(S,{list:c,onClick:e})]})}function H({list:e,onClick:n}){return a(T,{list:e,component:D,onClick:n})}const Ie=e=>p(m({},e),{fullName:`${e.name} Victory`}),Ge=e=>p(m({},e),{fullName:`${e.name} ${e.subtitle||""} Combo`}),we=e=>p(m({},e),{fullName:`${e.name} ${e.subtitle||""} Force Strike`}),Pe=e=>p(m({},e),{fullName:e.subtitle?`${e.subtitle} ${e.name}`:e.name}),We={uniqueCombo:Ge,uniqueFS:we,uniqueVictory:Ie,uniqueSkill:Pe};function U({name:e,onSelect:n}){var r,A;const t=`ani-${e}`,o=(r=v(h=>h[t]))!=null?r:{},{setGroupWeaponType:c}=g(h=>h.advAni.groupByWeapon),i=h=>c(e,h),l=g(h=>h.advAni.groupByWeapon[e]);l!=null||i(Object.keys(o)[0]);const u=We[e],s=u?(A=o[l])==null?void 0:A.map(u):o[l];return d("div",{className:"AniGroup",children:[a(x,{value:l,onClick:i}),a(H,{list:s,onClick:n},l)]})}function Ee({onSelect:e}){const n=v(t=>t["ani-misc"]);return a(S,{list:n,onClick:e})}function Fe({expanded:e,user:n,name:t,animations:o,onClick:c,onSelect:i}){return d(f,{children:[d("div",{className:`UniqueAniGroup ${e?"selected":""}`,"data-user":n,onClick:c,children:[a(ce,{modelId:n,alt:t}),a("h3",{children:t})]}),e&&a("div",{className:"UniqueAniGroup-details",children:a(S,{list:o,onClick:i})})]})}function Oe({onSelect:e}){const n=v(s=>s["ani-uniqueOther"]),{type:t,setType:o,selected:c,setSelected:i}=g(s=>s.advAni.uniqueOther),l=n[t],u=s=>{const{user:r}=s.currentTarget.dataset;i(r===c?"":r)};return a(f,{children:d("div",{className:"OtherUniqueAni",children:[a(x,{value:t,onClick:o}),a("hr",{}),a("div",{className:"OtherUniqueAni-groups",children:l.map(s=>a(Fe,p(m({expanded:c===s.user},s),{onClick:u,onSelect:e})))})]})})}const De={home:qe,quest:$e,weapon:Le,genericSkill:je,uniqueSkill:e=>a(U,p(m({},e),{name:"uniqueSkill"})),uniqueVictory:e=>a(U,p(m({},e),{name:"uniqueVictory"})),uniqueFS:e=>a(U,p(m({},e),{name:"uniqueFS"})),uniqueCombo:e=>a(U,p(m({},e),{name:"uniqueCombo"})),uniqueOther:Oe,misc:Ee};function Re({onSelect:e}){var c;const{category:n,setCategory:t}=g(i=>i.advAni),o=(c=De[n])!=null?c:$;return d("div",{className:"AniSelect-categories",children:[a(R,{tabs:Ce,value:n,onChange:t}),a("div",{className:"AniSelect-subCategory",children:a(o,{onSelect:e})})]})}function He(){const{source:e,setSource:n,sourceName:t,setSourceName:o}=g(s=>s.personalAni),{inputModel:c}=ne(),i=(s,r)=>{o(r),n(s)},l=async()=>{const s=await c();s&&i(...s)};C(()=>{t||setTimeout(async()=>{const s=await ae(e);(s==null?void 0:s.id)&&o(s.name)})},[e]);const u=["b","w"].includes(e==null?void 0:e[0])?`img/icon/${e}.png`:`img/portrait/${e}.png`;return d("div",{className:"PersonalAni-source",children:[e&&a("img",{src:u,alt:e},e),d("div",{children:[a("h3",{children:t}),a(y,{variant:"outlined",onClick:l,children:"Change Source"})]})]})}function Ve({onSelect:e}){const n=!!indexedDB,{source:t}=g(i=>i.personalAni),[o,c]=b([]);return C(()=>{c([]),setTimeout(async()=>{var u;if(!t)return;const l=((u=te(t))!=null?u:n?await le(t):[]).map(s=>p(m({},s),{user:void 0}));c(l)})},[t]),a(H,{list:o,onClick:e})}function ze({onSelect:e}){return d("div",{className:"PersonalAnimation",children:[a(He,{}),a(Ve,{onSelect:e})]})}function Ke({onSelect:e}){const{category:n,setCategory:t}=g(i=>i.extraAni),o=v(i=>i["ani-extra"]),c=Object.keys(o).map(i=>({name:i}));return d("div",{className:"AniSelect-categories",children:[a(R,{tabs:c,value:n,onChange:t}),a("div",{className:"AniSelect-subCategory",children:a(S,{list:o[n],onClick:e})})]})}function _e(o){var c=o,{initText:e,onChange:n=i=>{}}=c,t=q(c,["initText","onChange"]);const[i,l]=b(e),[u,s]=me(),r=h=>{const{value:N}=h.target;l(N),n(h)},A=h=>{h.keyCode===13&&s()};return C(()=>{l(e)},[e]),u?d(f,{children:[a(y,{title:"Save",onClick:s,children:a(ve,{})}),a("input",m({value:i,onChange:r,onKeyUp:A},t))]}):d(f,{children:[a(y,{title:"Edit",onClick:s,children:a(Ae,{})}),a("div",p(m({},t),{children:i}))]})}function Qe({list:e,onSelect:n}){const t=o=>{const{value:c}=o.target,{uuid:i}=o.target.dataset,l=e.find(u=>u.uuid===i);l.name=c};return a("div",{className:"AnimationList",children:e==null?void 0:e.map(o=>d(f,{children:[a(_e,{initText:o.name,onChange:t,className:"AnimationList-aniName","data-uuid":o.uuid}),a(y,{"data-code":`ex:${o.uuid}`,"data-name":o.name,onClick:n,variant:"contained",children:"Select"})]}))})}function Ye({onSelect:e}){const{userData:n}=oe,[t,o]=re();return C(()=>{const i=n.ani.addEventListener("change",o);return()=>n.ani.removeEventListener("change",i)}),d("div",{className:"UploadedAni",children:[a(ue,{multiple:!0,mimeType:".fbx",onChange:async i=>{const l=Array.from(i),u=await Promise.all(l.map(de)),r=(await Promise.all(u.map(ge))).map(A=>A.animations).flat();n.ani.push(...r)}}),a(Qe,{list:n.ani,onSelect:e},t)]})}const G={root:{display:"flex",flexDirection:"column",overflowY:"hidden",minHeight:"90vh",minWidth:"20rem","& svg":{color:"rgba(16, 16, 16, 0.8)"}},title:{textAlign:"center",padding:"0.5rem 2rem",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center",borderBottom:"1px solid rgba(16, 16, 16, 0.4)",boxShadow:"0 0.2rem 0.3rem rgba(16, 16, 16, 0.4)","& h2":{padding:"0.2rem 1rem"},"& Searchbox":{minWidth:"15rem"}},content:{padding:"0.5rem 1rem"}};const Xe=[{name:"Adv"},{name:"Personal"},{name:"Extra"},{name:"Upload",icon:a(fe,{}),label:""}],Je={Adv:Re,Personal:ze,Extra:Ke,Upload:Ye};function yn({onSelect:e=()=>{},onAfterSelect:n}){var h;const{category:t,setCategory:o}=g(),c=!!indexedDB,[i,l]=b(""),u=Y(i,500),s=(N,k)=>o(k),r=N=>{const{code:k,name:w}=N.currentTarget.dataset;console.log(k,w),e(k,w),n==null||n()},A=(h=Je[t])!=null?h:$;return d(O,{className:"AniSelect",sx:G.root,children:[d(O,{sx:G.title,children:[a(pe,{children:"Select an Animation"}),c&&a(X,{placeholder:"Search",query:i,onChange:l})]}),i?a(be,{query:u,onSelect:r}):d(f,{children:[a(ee,{value:t,onChange:s,tabs:Xe}),d(he,{sx:G.content,children:[a($,{}),a(A,{onSelect:r})]})]})]})}export{yn as default};
