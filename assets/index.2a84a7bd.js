var R=Object.defineProperty,F=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var C=(t,e,o)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,m=(t,e)=>{for(var o in e||(e={}))y.call(e,o)&&C(t,o,e[o]);if(g)for(var o of g(e))k.call(e,o)&&C(t,o,e[o]);return t},v=(t,e)=>F(t,W(e));var h=(t,e)=>{var o={};for(var a in t)y.call(t,a)&&e.indexOf(a)<0&&(o[a]=t[a]);if(t!=null&&g)for(var a of g(t))e.indexOf(a)<0&&k.call(t,a)&&(o[a]=t[a]);return o};import{aC as $,aG as j}from"./vendor.7867cdc7.js";import{T as L}from"./TabBar.1dfb1e88.js";import{C as G}from"./ColorPicker.6080bcef.js";import{u as B}from"./useAppData.dd089d42.js";import{G as A}from"./Gallery.c24aeda5.js";import{j as n,a as p,F as S,v as T}from"./index.7875a9f2.js";import{B as f}from"./Box.8f7dd023.js";import{B as U}from"./Button.cbd570fd.js";import{T as z}from"./TextField.4b71dc25.js";import{D as N,a as E}from"./DialogTitle.12f4a490.js";import"./ButtonBase.c570257e.js";import"./Popover.202a4dff.js";import"./ColorButton.282bdcd8.js";import"./DialogContext.c5249012.js";const x={gallery:{gap:"1rem"},container:{boxSizing:"border-box",maxWidth:"8rem",maxHeight:"8rem",position:"relative",cursor:"pointer",borderRadius:"5%",overflow:"hidden",filter:"drop-shadow(0 0 2px rgba(0,0,0,0.5))",objectFit:"cover",contentVisibility:"auto",containIntrinsicSize:"0 8rem",alignSelf:"stretch",margin:"auto","&:hover":{border:"1px solid white",filter:"drop-shadow(0.1rem 0.1rem 0.2rem black)"},"&[data-name]::after":{content:"attr(data-name)",position:"absolute",bottom:"0.25rem",left:0,backgroundColor:"rgba(0,0,0,0.8)",color:"#fff",textAlign:"center",padding:"0.1rem",width:"100%"},"&[data-name]:hover::after":{backgroundColor:"rgba(255,255,255,0.6)",color:"black"}},image:{maxWidth:"100%"}},H=({src:t,value:e,name:o,onClick:a})=>n(f,{sx:x.container,"data-name":o,children:n("img",{src:t,"data-value":e,onClick:a,style:x.image})}),w=({list:t,onClick:e})=>n(A,{style:x.gallery,onClick:e,list:t,component:H}),P={button:{padding:"0.5rem 1rem",margin:0,color:"rgba(16, 16, 16, 0.8)",border:"1px solid rgba(16, 16, 16, 0.5)","&:hover":{border:"1px solid rgba(16, 16, 16, 0.8)",backgroundColor:"rgba(210, 210, 210, 0.2)"}},input:{opacity:0,width:0,maxWidth:0}};function V(l){var c=l,{id:t="upload",multiple:e=!1,label:o="Upload",mimeType:a="image/*",onChange:i,style:r={}}=c,s=h(c,["id","multiple","label","mimeType","onChange","style"]);const d=$(),u=()=>{const b=d.current.files;i(b)},I=m(m({},P.button),r);return p(f,{children:[n(U,v(m({variant:"outlined",htmlFor:t,component:"label",sx:I},s),{children:o})),n("input",{name:t,id:t,type:"file",multiple:e,accept:a,style:P.input,ref:b=>d.current=b,onChange:u})]})}const D={input:{paddingRight:"0.2rem",minWidth:"8rem"},button:{padding:"0.5rem 1rem",margin:0,backgroundColor:"rgba(16, 16, 16, 0.8)",color:"rgba(255, 255, 255, 0.9)",border:"1px solid rgba(16, 16, 16, 0.5)","&:hover":{backgroundColor:"rgba(50, 50, 50, 0.8)",border:"1px solid rgba(16, 16, 16, 0.8)"}}};function _(a){var i=a,{onApply:t,applyLabel:e="Apply"}=i,o=h(i,["onApply","applyLabel"]);const[r,s]=j(""),l=u=>s(u.target.value),c=()=>t(r),d=n(U,{sx:D.button,variant:"contained",onClick:c,children:e});return n(z,m({value:r,onChange:l,placeholder:"Enter URL",margin:"none",InputProps:{endAdornment:d,sx:D.input},inputProps:{type:"url"},size:"small"},o))}const q=async t=>new Promise(e=>{const o=new FileReader;o.onload=a=>e(a.target.result),o.readAsDataURL(t)}),J={external:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem",maxWidth:"100%",marginBottom:"0.5rem"}};function K({onSelect:t}){const e=B(r=>r["background-image"]),o=r=>{const{value:s}=r.target.dataset,l=`img:${s}`;t(l)},a=async r=>{const l=`img:${await q(r[0])}`;t(l)},i=r=>{if(!r)return;const s=`img:${r}`;t(s)};return p(S,{children:[p(f,{sx:J.external,children:[n(V,{onChange:a}),n(_,{onApply:i})]}),n(w,{list:e,onClick:o})]})}function M({onSelect:t}){const e=B(a=>a["background-skybox"]);return n(w,{list:e,onClick:a=>{const{value:i}=a.target.dataset,r=`sky:${i}`;t(r)}})}const O=["Color","Image","Skybox"].map(t=>({name:t})),Q={Color:G,Image:K,Skybox:M},X=t=>t.startsWith("sky:")?"Skybox":t.startsWith("img:")?"Image":"Color";function pt({onAfterSelect:t}){var l;const e=X(T.background),[o,a]=j(e),i=c=>{T.background=c,t==null||t()},r=(c,d)=>a(d),s=(l=Q[o])!=null?l:()=>null;return p("div",{className:"BackgroundPicker",children:[n(N,{sx:{textAlign:"center"},children:"Choose a background"}),n(L,{value:o,onChange:r,tabs:O}),n(E,{children:n(s,{onSelect:i})})]})}export{pt as default};
