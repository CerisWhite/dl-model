var D=Object.defineProperty;var g=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var k=(t,o,a)=>o in t?D(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,m=(t,o)=>{for(var a in o||(o={}))x.call(o,a)&&k(t,a,o[a]);if(g)for(var a of g(o))y.call(o,a)&&k(t,a,o[a]);return t};var b=(t,o)=>{var a={};for(var e in t)x.call(t,e)&&o.indexOf(e)<0&&(a[e]=t[e]);if(t!=null&&g)for(var e of g(t))o.indexOf(e)<0&&y.call(t,e)&&(a[e]=t[e]);return a};import{ax as r,aA as I,aF as C,aD as R}from"./vendor.ffd395ab.js";import{T as W}from"./TabBar.d0be1a54.js";import{C as F}from"./ColorPicker.164fa37d.js";import{u as v}from"./useAppData.d907c9bc.js";import{G as $}from"./Gallery.edc5b06e.js";import{B as h}from"./Box.d6d5f65e.js";import{B}from"./Button.fc775fac.js";import{T as L}from"./TextField.6c373f07.js";import{v as j}from"./index.10d263a6.js";import{D as A,a as G}from"./DialogTitle.3ac1c173.js";import"./ButtonBase.e40964c1.js";import"./Popover.80b4a490.js";import"./ColorButton.91c9b9c8.js";import"./DialogContext.619db339.js";const f={gallery:{gap:"1rem"},container:{boxSizing:"border-box",maxWidth:"8rem",maxHeight:"8rem",position:"relative",cursor:"pointer",borderRadius:"5%",overflow:"hidden",filter:"drop-shadow(0 0 2px rgba(0,0,0,0.5))",objectFit:"cover",contentVisibility:"auto",containIntrinsicSize:"0 8rem",alignSelf:"stretch",margin:"auto","&:hover":{border:"1px solid white",filter:"drop-shadow(0.1rem 0.1rem 0.2rem black)"},"&[data-name]::after":{content:"attr(data-name)",position:"absolute",bottom:"0.25rem",left:0,backgroundColor:"rgba(0,0,0,0.8)",color:"#fff",textAlign:"center",padding:"0.1rem",width:"100%"},"&[data-name]:hover::after":{backgroundColor:"rgba(255,255,255,0.6)",color:"black"}},image:{maxWidth:"100%"}},S=({src:t,value:o,name:a,onClick:e})=>r(h,{sx:f.container,"data-name":a},r("img",{src:t,"data-value":o,onClick:e,style:f.image})),T=({list:t,onClick:o})=>r($,{style:f.gallery,onClick:o,list:t,component:S}),U={button:{padding:"0.5rem 1rem",margin:0,color:"rgba(16, 16, 16, 0.8)",border:"1px solid rgba(16, 16, 16, 0.5)","&:hover":{border:"1px solid rgba(16, 16, 16, 0.8)",backgroundColor:"rgba(210, 210, 210, 0.2)"}},input:{opacity:0,width:0,maxWidth:0}};function z(l){var c=l,{id:t="upload",multiple:o=!1,label:a="Upload",mimeType:e="image/*",onChange:s,style:n={}}=c,i=b(c,["id","multiple","label","mimeType","onChange","style"]);const d=I(),p=()=>{const u=d.current.files;s(u)},P=m(m({},U.button),n);return r(h,null,r(B,m({variant:"outlined",htmlFor:t,component:"label",sx:P},i),a),r("input",{name:t,id:t,type:"file",multiple:o,accept:e,style:U.input,ref:u=>d.current=u,onChange:p}))}const w={input:{paddingRight:"0.2rem",minWidth:"8rem"},button:{padding:"0.5rem 1rem",margin:0,backgroundColor:"rgba(16, 16, 16, 0.8)",color:"rgba(255, 255, 255, 0.9)",border:"1px solid rgba(16, 16, 16, 0.5)","&:hover":{backgroundColor:"rgba(50, 50, 50, 0.8)",border:"1px solid rgba(16, 16, 16, 0.8)"}}};function N(e){var s=e,{onApply:t,applyLabel:o="Apply"}=s,a=b(s,["onApply","applyLabel"]);const[n,i]=C(""),l=p=>i(p.target.value),c=()=>t(n),d=r(B,{sx:w.button,variant:"contained",onClick:c},o);return r(L,m({value:n,onChange:l,placeholder:"Enter URL",margin:"none",InputProps:{endAdornment:d,sx:w.input},inputProps:{type:"url"},size:"small"},a))}const E=async t=>new Promise(o=>{const a=new FileReader;a.onload=e=>o(e.target.result),a.readAsDataURL(t)}),H={external:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.5rem",maxWidth:"100%",marginBottom:"0.5rem"}};function V({onSelect:t}){const o=v(n=>n["background-image"]),a=n=>{const{value:i}=n.target.dataset,l=`img:${i}`;t(l)},e=async n=>{const l=`img:${await E(n[0])}`;t(l)},s=n=>{if(!n)return;const i=`img:${n}`;t(i)};return r(R,null,r(h,{sx:H.external},r(z,{onChange:e}),r(N,{onApply:s})),r(T,{list:o,onClick:a}))}function _({onSelect:t}){const o=v(e=>e["background-skybox"]);return r(T,{list:o,onClick:e=>{const{value:s}=e.target.dataset,n=`sky:${s}`;t(n)}})}const q=["Color","Image","Skybox"].map(t=>({name:t})),J={Color:F,Image:V,Skybox:_},K=t=>t.startsWith("sky:")?"Skybox":t.startsWith("img:")?"Image":"Color";function ct({onAfterSelect:t}){var l;const o=K(j.background),[a,e]=C(o),s=c=>{j.background=c,t==null||t()},n=(c,d)=>e(d),i=(l=J[a])!=null?l:()=>null;return r("div",{className:"BackgroundPicker"},r(A,{sx:{textAlign:"center"}},"Choose a background"),r(W,{value:a,onChange:n,tabs:q}),r(G,null,r(i,{onSelect:s})))}export{ct as default};
