import{ax as t,aD as A,aA as S,aF as x,aB as L}from"./vendor.dead0e45.js";import{u as k}from"./useKey.c0faf57c.js";import{a as j,j as N,G as T,v}from"./index.aa157edd.js";import{S as w}from"./Stretcher.f31308d6.js";import{A as I,b as M,a as E}from"./AttachmentSetting.08922d8d.js";import{B}from"./Button.21dca63e.js";import{a as F,D as G}from"./DialogTitle.ba06c24c.js";import{B as u}from"./Box.93a277ea.js";import{S as K}from"./TextField.a09e8e5c.js";import{M as P}from"./MenuItem.8bfdfe3d.js";/* empty css               */import"./ModelIcon.919d14fb.js";import"./useToggleState.8cff7b60.js";import"./ButtonBase.7e212a37.js";import"./Popover.92ce4ff4.js";import"./ColorButton.fce2587a.js";import"./Close.27d103a5.js";import"./DialogContext.3bb3b8e3.js";function $({bone:e,add:m}){var s;const{activeModel:o}=j(),l=(s=o==null?void 0:o.attachment[e])!=null?s:[];return t(E,{defaultOpen:!0,className:"BoneManager",disableGutters:!0},t(A,null,t("div",{className:"BoneManager-name"},e),t(B,{variant:"contained",className:"BoneManager-add",onClick:n=>{n.stopPropagation(),m(e)}},t(M,null))),t(A,null,l.map(n=>{var c,d;return t(I,{target:n,label:(d=(c=n==null?void 0:n.userData)==null?void 0:c.name)!=null?d:n.id})})))}function ot(){var g,h;const{activeModel:e}=j(),[m,o]=k(),{inputModel:l}=N(),r=S(()=>{}),s=["root",...(h=(g=e==null?void 0:e.bones)==null?void 0:g.list)!=null?h:[]],[n,c]=x(s[0]),d=T(e.attachment.list.map(a=>a.parentBone));L(()=>{if(!e)return;r.current();const a=e.addEventListener("AttachmentChanged",o);return r.current=()=>e.removeEventListener("AttachmentChanged",a),r.current},[e]);const b=a=>{c(a.target.value)},p=async(a=n)=>{const f=await l();if(!f)return;const[y,D]=f,i=await v.loadDLModel(y);i.userData.name=D,e.attach(i,a==="root"?void 0:a),i.outline.code=e.outline.code,i.material.code=e.material.code,v.render()},C=()=>p();return t(u,{className:"AttachmentManager"},t(u,{className:"AttachmentManager-top"},t(G,null,"Manage Attachments"),t(u,{className:"AttachmentManager-add"},t(K,{onChange:b,value:n,className:"AttachmentManager-select"},s.map(a=>t(P,{key:a,value:a},a))),t(B,{title:"Add Attachment",variant:"contained",onClick:C},t(M,null)))),t(F,{key:m,className:"AttachmentManager-body"},t(w,null),d.map(a=>t($,{add:p,key:a,bone:a}))))}export{ot as default};
