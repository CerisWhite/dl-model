import{ax as e,aD as A,aA as S,aF as x,aB as L}from"./vendor.dead0e45.js";import{u as k}from"./useKey.c0faf57c.js";import{a as j,j as N,G as T,v}from"./index.7a3f7ee4.js";import{S as w}from"./Stretcher.f31308d6.js";import{A as I,b as M,a as E}from"./AttachmentSetting.4b060f7e.js";import{B}from"./Button.21dca63e.js";import{a as F,D as G}from"./DialogTitle.ba06c24c.js";import{B as u}from"./Box.93a277ea.js";import{S as K}from"./TextField.a09e8e5c.js";import{M as P}from"./MenuItem.8bfdfe3d.js";/* empty css               */import"./ModelIcon.919d14fb.js";import"./useToggleState.8cff7b60.js";import"./ButtonBase.7e212a37.js";import"./Popover.92ce4ff4.js";import"./ColorButton.fce2587a.js";import"./Close.27d103a5.js";import"./DialogContext.3bb3b8e3.js";function $({bone:t,add:d}){var s;const{activeModel:o}=j(),l=(s=o==null?void 0:o.attachment[t])!=null?s:[];return e(E,{defaultOpen:!0,className:"BoneManager",disableGutters:!0},e(A,null,e("div",{className:"BoneManager-name"},t),e(B,{variant:"contained",className:"BoneManager-add",onClick:n=>{n.stopPropagation(),d(t)}},e(M,null))),e(A,null,l.map(n=>{var c,i;return e(I,{target:n,label:(i=(c=n==null?void 0:n.userData)==null?void 0:c.name)!=null?i:n.id})})))}function oe(){var f,g;const{activeModel:t}=j(),[d,o]=k(),{inputModel:l}=N(),r=S(()=>{}),s=["root",...(g=(f=t==null?void 0:t.bones)==null?void 0:f.list)!=null?g:[]],[n,c]=x(s[0]),i=T(t.attachment.list.map(a=>a.parentBone));L(()=>{if(!t)return;r.current();const a=t.addEventListener("AttachmentChanged",o);return r.current=()=>t.removeEventListener("AttachmentChanged",a),r.current},[t]);const b=a=>{c(a.target.value)},p=async(a=n)=>{const h=await l();if(!h)return;const[y,D]=h,m=await v.loadDLModel(y);m.userData.name=D,t.attach(m,a==="root"?void 0:a),m.outline.code=t.outline.code,m.material.code=t.material.code,v.render()},C=()=>p();return e(u,{className:"AttachmentManager"},e(u,{className:"AttachmentManager-top"},e(G,null,"Manage Attachments"),e(u,{className:"AttachmentManager-add"},e(K,{onChange:b,value:n,className:"AttachmentManager-select"},s.map(a=>e(P,{key:a,value:a},a))),e(B,{title:"Add Attachment",variant:"contained",onClick:C},e(M,null)))),e(F,{key:d,className:"AttachmentManager-body"},e(w,null),i.map(a=>e($,{add:p,key:a,bone:a}))))}export{oe as default};
