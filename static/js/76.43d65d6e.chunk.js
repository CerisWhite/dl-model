(this["webpackJsonpdl-model"]=this["webpackJsonpdl-model"]||[]).push([[76],{497:function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFExporter",(function(){return n}));var s=r(0),a=r(2),i=r(3),n=function(){function e(){Object(s.a)(this,e),this.pluginCallbacks=[],this.register((function(e){return new U(e)})),this.register((function(e){return new B(e)})),this.register((function(e){return new C(e)}))}return Object(a.a)(e,[{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,r){for(var s=new O,a=[],i=0,n=this.pluginCallbacks.length;i<n;i++)a.push(this.pluginCallbacks[i](s));s.setPlugins(a),s.write(e,t,r)}}]),e}(),o=0,l=1,u=2,h=3,c=4,p=5121,f=5123,m=5126,g=5125,d=34962,v=34963,y=9728,b=9729,x=9984,w=9985,T=9986,M=9987,A=33071,E=33648,I=10497,k={};k[i.NearestFilter]=y,k[i.NearestMipmapNearestFilter]=x,k[i.NearestMipmapLinearFilter]=T,k[i.LinearFilter]=b,k[i.LinearMipmapNearestFilter]=w,k[i.LinearMipmapLinearFilter]=M,k[i.ClampToEdgeWrapping]=A,k[i.RepeatWrapping]=I,k[i.MirroredRepeatWrapping]=E;var L={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function S(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}function R(e){return 4*Math.ceil(e/4)}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=R(e.byteLength);if(r!==e.byteLength){var s=new Uint8Array(r);if(s.set(new Uint8Array(e)),0!==t)for(var a=e.byteLength;a<r;a++)s[a]=t;return s.buffer}return e}var N=null,O=function(){function e(){Object(s.a)(this,e),this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}return Object(a.a)(e,[{key:"setPlugins",value:function(e){this.plugins=e}},{key:"write",value:function(e,t,r){this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e);var s=this;Promise.all(this.pending).then((function(){var e=s.buffers,r=s.json,a=s.options,i=s.extensionsUsed,n=new Blob(e,{type:"application/octet-stream"}),o=Object.keys(i);if(o.length>0&&(r.extensionsUsed=o),r.buffers&&r.buffers.length>0&&(r.buffers[0].byteLength=n.size),!0===a.binary){var l=new window.FileReader;l.readAsArrayBuffer(n),l.onloadend=function(){var e=F(l.result),s=new DataView(new ArrayBuffer(8));s.setUint32(0,e.byteLength,!0),s.setUint32(4,5130562,!0);var a=F(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,s=e.length;r<s;r++){var a=e.charCodeAt(r);t[r]=a>255?32:a}return t.buffer}(JSON.stringify(r)),32),i=new DataView(new ArrayBuffer(8));i.setUint32(0,a.byteLength,!0),i.setUint32(4,1313821514,!0);var n=new ArrayBuffer(12),o=new DataView(n);o.setUint32(0,1179937895,!0),o.setUint32(4,2,!0);var u=12+i.byteLength+a.byteLength+s.byteLength+e.byteLength;o.setUint32(8,u,!0);var h=new Blob([n,i,a,s,e],{type:"application/octet-stream"}),c=new window.FileReader;c.readAsArrayBuffer(h),c.onloadend=function(){t(c.result)}}}else if(r.buffers&&r.buffers.length>0){var u=new window.FileReader;u.readAsDataURL(n),u.onloadend=function(){var e=u.result;r.buffers[0].uri=e,t(r)}}else t(r)}))}},{key:"serializeUserData",value:function(e,t){if(0!==Object.keys(e.userData).length){var r=this.options,s=this.extensionsUsed;try{var a=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&a.gltfExtensions){for(var i in void 0===t.extensions&&(t.extensions={}),a.gltfExtensions)t.extensions[i]=a.gltfExtensions[i],s[i]=!0;delete a.gltfExtensions}Object.keys(a).length>0&&(t.extras=a)}catch(n){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+n.message)}}}},{key:"getUID",value:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)}},{key:"isNormalizedNormalAttribute",value:function(e){if(this.cache.attributesNormalized.has(e))return!1;for(var t=new i.Vector3,r=0,s=e.count;r<s;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}},{key:"createNormalizedNormalAttribute",value:function(e){var t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);for(var r=e.clone(),s=new i.Vector3,a=0,n=r.count;a<n;a++)s.fromBufferAttribute(r,a),0===s.x&&0===s.y&&0===s.z?s.setX(1):s.normalize(),r.setXYZ(a,s.x,s.y,s.z);return t.attributesNormalized.set(e,r),r}},{key:"applyTextureTransform",value:function(e,t){var r=!1,s={};0===t.offset.x&&0===t.offset.y||(s.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(s.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(s.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}},{key:"processBuffer",value:function(e){var t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0}},{key:"processBufferView",value:function(e,t,r,s,a){var i,n=this.json;n.bufferViews||(n.bufferViews=[]),i=t===p?1:t===f?2:4;for(var o=R(s*e.itemSize*i),l=new DataView(new ArrayBuffer(o)),u=0,h=r;h<r+s;h++)for(var c=0;c<e.itemSize;c++){var v=void 0;e.itemSize>4?v=e.array[h*e.itemSize+c]:0===c?v=e.getX(h):1===c?v=e.getY(h):2===c?v=e.getZ(h):3===c&&(v=e.getW(h)),t===m?l.setFloat32(u,v,!0):t===g?l.setUint32(u,v,!0):t===f?l.setUint16(u,v,!0):t===p&&l.setUint8(u,v),u+=i}var y={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:o};return void 0!==a&&(y.target=a),a===d&&(y.byteStride=e.itemSize*i),this.byteOffset+=o,n.bufferViews.push(y),{id:n.bufferViews.length-1,byteLength:0}}},{key:"processBufferViewImage",value:function(e){var t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise((function(s){var a=new window.FileReader;a.readAsArrayBuffer(e),a.onloadend=function(){var e=F(a.result),i={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,s(r.bufferViews.push(i)-1)}}))}},{key:"processAccessor",value:function(e,t,r,s){var a,i=this.options,n=this.json;if(e.array.constructor===Float32Array)a=m;else if(e.array.constructor===Uint32Array)a=g;else if(e.array.constructor===Uint16Array)a=f;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");a=p}if(void 0===r&&(r=0),void 0===s&&(s=e.count),i.truncateDrawRange&&void 0!==t&&null===t.index){var o=r+s,l=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;r=Math.max(r,t.drawRange.start),(s=Math.min(o,l)-r)<0&&(s=0)}if(0===s)return null;var u,h=function(e,t,r){for(var s={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},a=t;a<t+r;a++)for(var i=0;i<e.itemSize;i++){var n=void 0;e.itemSize>4?n=e.array[a*e.itemSize+i]:0===i?n=e.getX(a):1===i?n=e.getY(a):2===i?n=e.getZ(a):3===i&&(n=e.getW(a)),s.min[i]=Math.min(s.min[i],n),s.max[i]=Math.max(s.max[i],n)}return s}(e,r,s);void 0!==t&&(u=e===t.index?v:d);var c=this.processBufferView(e,a,r,s,u),y={bufferView:c.id,byteOffset:c.byteOffset,componentType:a,count:s,max:h.max,min:h.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(y.normalized=!0),n.accessors||(n.accessors=[]),n.accessors.push(y)-1}},{key:"processImage",value:function(e,t,r){var s=this,a=s.cache,n=s.json,o=s.options,l=s.pending;a.images.has(e)||a.images.set(e,{});var u=a.images.get(e),h=t===i.RGBAFormat?"image/png":"image/jpeg",c=h+":flipY/"+r.toString();if(void 0!==u[c])return u[c];n.images||(n.images=[]);var p={mimeType:h};if(o.embedImages){var f=N=N||document.createElement("canvas");f.width=Math.min(e.width,o.maxTextureSize),f.height=Math.min(e.height,o.maxTextureSize);var m=f.getContext("2d");if(!0===r&&(m.translate(0,f.height),m.scale(1,-1)),"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap)m.drawImage(e,0,0,f.width,f.height);else{t!==i.RGBAFormat&&t!==i.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>o.maxTextureSize||e.height>o.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);var g=e.data;if(t===i.RGBFormat){g=new Uint8ClampedArray(e.height*e.width*4);for(var d=0,v=0;d<g.length;d+=4,v+=3)g[d+0]=e.data[v+0],g[d+1]=e.data[v+1],g[d+2]=e.data[v+2],g[d+3]=255}m.putImageData(new ImageData(g,e.width,e.height),0,0)}!0===o.binary?l.push(new Promise((function(e){f.toBlob((function(t){s.processBufferViewImage(t).then((function(t){p.bufferView=t,e()}))}),h)}))):p.uri=f.toDataURL(h)}else p.uri=e.src;var y=n.images.push(p)-1;return u[c]=y,y}},{key:"processSampler",value:function(e){var t=this.json;t.samplers||(t.samplers=[]);var r={magFilter:k[e.magFilter],minFilter:k[e.minFilter],wrapS:k[e.wrapS],wrapT:k[e.wrapT]};return t.samplers.push(r)-1}},{key:"processTexture",value:function(e){var t=this.cache,r=this.json;if(t.textures.has(e))return t.textures.get(e);r.textures||(r.textures=[]);var s={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(s.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,s)}));var a=r.textures.push(s)-1;return t.textures.set(e,a),a}},{key:"processMaterial",value:function(e){var t=this.cache,r=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);var s={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var a=e.color.toArray().concat([e.opacity]);if(S(a,[1,1,1,1])||(s.pbrMetallicRoughness.baseColorFactor=a),e.isMeshStandardMaterial?(s.pbrMetallicRoughness.metallicFactor=e.metalness,s.pbrMetallicRoughness.roughnessFactor=e.roughness):(s.pbrMetallicRoughness.metallicFactor=.5,s.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var n={index:this.processTexture(e.metalnessMap)};this.applyTextureTransform(n,e.metalnessMap),s.pbrMetallicRoughness.metallicRoughnessTexture=n}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:this.processTexture(e.map)};this.applyTextureTransform(o,e.map),s.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){var l=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(S(l,[0,0,0])||(s.emissiveFactor=l),e.emissiveMap){var u={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(u,e.emissiveMap),s.emissiveTexture=u}}if(e.normalMap){var h={index:this.processTexture(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),h.scale=e.normalScale.x),this.applyTextureTransform(h,e.normalMap),s.normalTexture=h}if(e.aoMap){var c={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(c.strength=e.aoMapIntensity),this.applyTextureTransform(c,e.aoMap),s.occlusionTexture=c}e.transparent?s.alphaMode="BLEND":e.alphaTest>0&&(s.alphaMode="MASK",s.alphaCutoff=e.alphaTest),e.side===i.DoubleSide&&(s.doubleSided=!0),""!==e.name&&(s.name=e.name),this.serializeUserData(e,s),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,s)}));var p=r.materials.push(s)-1;return t.materials.set(e,p),p}},{key:"processMesh",value:function(e){var t=this.cache,r=this.json,s=[e.geometry.uuid];if(Array.isArray(e.material))for(var a=0,n=e.material.length;a<n;a++)s.push(e.material[a].uuid);else s.push(e.material.uuid);var p=s.join(":");if(t.meshes.has(p))return t.meshes.get(p);var f,m=e.geometry;if(f=e.isLineSegments?l:e.isLineLoop?u:e.isLine?h:e.isPoints?o:e.material.wireframe?l:c,!0!==m.isBufferGeometry)throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");var g={},d={},v=[],y=[],b={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},x=m.getAttribute("normal");void 0===x||this.isNormalizedNormalAttribute(x)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),m.setAttribute("normal",this.createNormalizedNormalAttribute(x)));var w=null;for(var T in m.attributes)if("morph"!==T.substr(0,5)){var M=m.attributes[T];T=b[T]||T.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(T)||(T="_"+T),t.attributes.has(this.getUID(M)))d[T]=t.attributes.get(this.getUID(M));else{w=null;var A=M.array;"JOINTS_0"!==T||A instanceof Uint16Array||A instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),w=new i.BufferAttribute(new Uint16Array(A),M.itemSize,M.normalized));var E=this.processAccessor(w||M,m);null!==E&&(d[T]=E,t.attributes.set(this.getUID(M),E))}}if(void 0!==x&&m.setAttribute("normal",x),0===Object.keys(d).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var I=[],k=[],L={};if(void 0!==e.morphTargetDictionary)for(var S in e.morphTargetDictionary)L[e.morphTargetDictionary[S]]=S;for(var R=0;R<e.morphTargetInfluences.length;++R){var F={},N=!1;for(var O in m.morphAttributes)if("position"===O||"normal"===O){var U=m.morphAttributes[O][R],B=O.toUpperCase(),C=m.attributes[O];if(t.attributes.has(this.getUID(U)))F[B]=t.attributes.get(this.getUID(U));else{var z=U.clone();if(!m.morphTargetsRelative)for(var D=0,G=U.count;D<G;D++)z.setXYZ(D,U.getX(D)-C.getX(D),U.getY(D)-C.getY(D),U.getZ(D)-C.getZ(D));F[B]=this.processAccessor(z,m),t.attributes.set(this.getUID(C),F[B])}}else N||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),N=!0);y.push(F),I.push(e.morphTargetInfluences[R]),void 0!==e.morphTargetDictionary&&k.push(L[R])}g.weights=I,k.length>0&&(g.extras={},g.extras.targetNames=k)}var j=Array.isArray(e.material);if(j&&0===m.groups.length)return null;for(var V=j?e.material:[e.material],_=j?m.groups:[{materialIndex:0,start:void 0,count:void 0}],H=0,P=_.length;H<P;H++){var X={mode:f,attributes:d};if(this.serializeUserData(m,X),y.length>0&&(X.targets=y),null!==m.index){var Y=this.getUID(m.index);void 0===_[H].start&&void 0===_[H].count||(Y+=":"+_[H].start+":"+_[H].count),t.attributes.has(Y)?X.indices=t.attributes.get(Y):(X.indices=this.processAccessor(m.index,m,_[H].start,_[H].count),t.attributes.set(Y,X.indices)),null===X.indices&&delete X.indices}var J=this.processMaterial(V[_[H].materialIndex]);null!==J&&(X.material=J),v.push(X)}g.primitives=v,r.meshes||(r.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,g)}));var K=r.meshes.push(g)-1;return t.meshes.set(p,K),K}},{key:"processCamera",value:function(e){var t=this.json;t.cameras||(t.cameras=[]);var r=e.isOrthographicCamera,s={type:r?"orthographic":"perspective"};return r?s.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:s.perspective={aspectRatio:e.aspect,yfov:i.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(s.name=e.type),t.cameras.push(s)-1}},{key:"processAnimation",value:function(e,t){var r=this.json,s=this.nodeMap;r.animations||(r.animations=[]);for(var a=(e=n.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],l=[],u=0;u<a.length;++u){var h=a[u],c=i.PropertyBinding.parseTrackName(h.name),p=i.PropertyBinding.findNode(t,c.nodeName),f=L[c.propertyName];if("bones"===c.objectName&&(p=!0===p.isSkinnedMesh?p.skeleton.getBoneByName(c.objectIndex):void 0),!p||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',h.name),null;var m=h.values.length/h.times.length;f===L.morphTargetInfluences&&(m/=p.morphTargetInfluences.length);var g=void 0;!0===h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(g="CUBICSPLINE",m/=3):g=h.getInterpolation()===i.InterpolateDiscrete?"STEP":"LINEAR",l.push({input:this.processAccessor(new i.BufferAttribute(h.times,1)),output:this.processAccessor(new i.BufferAttribute(h.values,m)),interpolation:g}),o.push({sampler:l.length-1,target:{node:s.get(p),path:f}})}return r.animations.push({name:e.name||"clip_"+r.animations.length,samplers:l,channels:o}),r.animations.length-1}},{key:"processSkin",value:function(e){var t=this.json,r=this.nodeMap,s=t.nodes[r.get(e)],a=e.skeleton;if(void 0===a)return null;var n=e.skeleton.bones[0];if(void 0===n)return null;for(var o=[],l=new Float32Array(16*a.bones.length),u=new i.Matrix4,h=0;h<a.bones.length;++h)o.push(r.get(a.bones[h])),u.copy(a.boneInverses[h]),u.multiply(e.bindMatrix).toArray(l,16*h);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new i.BufferAttribute(l,16)),joints:o,skeleton:r.get(n)}),s.skin=t.skins.length-1}},{key:"processNode",value:function(e){var t=this.json,r=this.options,s=this.nodeMap;t.nodes||(t.nodes=[]);var a={};if(r.trs){var i=e.quaternion.toArray(),n=e.position.toArray(),o=e.scale.toArray();S(i,[0,0,0,1])||(a.rotation=i),S(n,[0,0,0])||(a.translation=n),S(o,[1,1,1])||(a.scale=o)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===S(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(a.matrix=e.matrix.elements);if(""!==e.name&&(a.name=String(e.name)),this.serializeUserData(e,a),e.isMesh||e.isLine||e.isPoints){var l=this.processMesh(e);null!==l&&(a.mesh=l)}else e.isCamera&&(a.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){for(var u=[],h=0,c=e.children.length;h<c;h++){var p=e.children[h];if(p.visible||!1===r.onlyVisible){var f=this.processNode(p);null!==f&&u.push(f)}}u.length>0&&(a.children=u)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,a)}));var m=t.nodes.push(a)-1;return s.set(e,m),m}},{key:"processScene",value:function(e){var t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);var s={};""!==e.name&&(s.name=e.name),t.scenes.push(s);for(var a=[],i=0,n=e.children.length;i<n;i++){var o=e.children[i];if(o.visible||!1===r.onlyVisible){var l=this.processNode(o);null!==l&&a.push(l)}}a.length>0&&(s.nodes=a),this.serializeUserData(e,s)}},{key:"processObjects",value:function(e){var t=new i.Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);this.processScene(t)}},{key:"processInput",value:function(e){var t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));for(var r=[],s=0;s<e.length;s++)e[s]instanceof i.Scene?this.processScene(e[s]):r.push(e[s]);r.length>0&&this.processObjects(r);for(var a=0;a<this.skins.length;++a)this.processSkin(this.skins[a]);for(var n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}},{key:"_invokeAll",value:function(e){for(var t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}}]),e}(),U=function(){function e(t){Object(s.a)(this,e),this.writer=t,this.name="KHR_lights_punctual"}return Object(a.a)(e,[{key:"writeNode",value:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var r=this.writer,s=r.json,a=r.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,i.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),a[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},a[this.name]=!0);var n=s.extensions[this.name].lights;n.push(i),t.extensions=t.extensions||{},t.extensions[this.name]={light:n.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}}]),e}(),B=function(){function e(t){Object(s.a)(this,e),this.writer=t,this.name="KHR_materials_unlit"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshBasicMaterial){var r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}}]),e}(),C=function(){function e(t){Object(s.a)(this,e),this.writer=t,this.name="KHR_materials_pbrSpecularGlossiness"}return Object(a.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var r=this.writer,s=r.extensionsUsed,a={};t.pbrMetallicRoughness.baseColorFactor&&(a.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var i=[1,1,1];if(e.specular.toArray(i,0),a.specularFactor=i,a.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(a.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var n={index:r.processTexture(e.specularMap)};r.applyTextureTransform(n,e.specularMap),a.specularGlossinessTexture=n}t.extensions=t.extensions||{},t.extensions[this.name]=a,s[this.name]=!0}}}]),e}();n.Utils={insertKeyframe:function(e,t){var r,s=.001,a=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),n=new e.ValueBufferType(e.values.length+a),o=e.createInterpolant(new e.ValueBufferType(a));if(0===e.times.length){i[0]=t;for(var l=0;l<a;l++)n[l]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<s)return 0;i[0]=t,i.set(e.times,1),n.set(o.evaluate(t),0),n.set(e.values,a),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<s)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),n.set(e.values,0),n.set(o.evaluate(t),e.values.length),r=i.length-1}else for(var u=0;u<e.times.length;u++){if(Math.abs(e.times[u]-t)<s)return u;if(e.times[u]<t&&e.times[u+1]>t){i.set(e.times.slice(0,u+1),0),i[u+1]=t,i.set(e.times.slice(u+1),u+2),n.set(e.values.slice(0,(u+1)*a),0),n.set(o.evaluate(t),(u+1)*a),n.set(e.values.slice((u+1)*a),(u+2)*a),r=u+1;break}}return e.times=i,e.values=n,r},mergeMorphTargetTracks:function(e,t){for(var r=[],s={},a=e.tracks,n=0;n<a.length;++n){var o=a[n],l=i.PropertyBinding.parseTrackName(o.name),u=i.PropertyBinding.findNode(t,l.nodeName);if("morphTargetInfluences"===l.propertyName&&void 0!==l.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(i.InterpolateLinear)}var h=u.morphTargetInfluences.length,c=u.morphTargetDictionary[l.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);var p=void 0;if(void 0!==s[u.uuid]){var f=o.createInterpolant(new o.ValueBufferType(1));p=s[u.uuid];for(var m=0;m<p.times.length;m++)p.values[m*h+c]=f.evaluate(p.times[m]);for(var g=0;g<o.times.length;g++){var d=this.insertKeyframe(p,o.times[g]);p.values[d*h+c]=o.values[g]}}else{for(var v=new((p=o.clone()).ValueBufferType)(h*p.times.length),y=0;y<p.times.length;y++)v[y*h+c]=p.values[y];p.name=(l.nodeName||"")+".morphTargetInfluences",p.values=v,s[u.uuid]=p,r.push(p)}}else r.push(o)}return e.tracks=r,e}}}}]);
//# sourceMappingURL=76.43d65d6e.chunk.js.map