(this["webpackJsonpdl-model"]=this["webpackJsonpdl-model"]||[]).push([[17],{497:function(t,e,n){"use strict";n.r(e),n.d(e,"PLYExporter",(function(){return o}));var r=n(1),o=function(){};o.prototype={constructor:o,parse:function(t,e,n){function o(e){t.traverse((function(t){if(!0===t.isMesh){var n=t,r=n.geometry;if(!0!==r.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");!0===r.hasAttribute("position")&&e(n,r)}}))}e&&"object"===typeof e&&(console.warn('THREE.PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),n=e,e=void 0);var i=(n=Object.assign({binary:!1,excludeAttributes:[],littleEndian:!1},n)).excludeAttributes,a=!1,l=!1,u=!1,c=0,s=0;t.traverse((function(t){if(!0===t.isMesh){var e=t.geometry;if(!0!==e.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");var n=e.getAttribute("position"),r=e.getAttribute("normal"),o=e.getAttribute("uv"),i=e.getAttribute("color"),f=e.getIndex();if(void 0===n)return;c+=n.count,s+=f?f.count/3:n.count/3,void 0!==r&&(a=!0),void 0!==o&&(u=!0),void 0!==i&&(l=!0)}}));var f=-1===i.indexOf("index");if(a=a&&-1===i.indexOf("normal"),l=l&&-1===i.indexOf("color"),u=u&&-1===i.indexOf("uv"),f&&s!==Math.floor(s))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var d="ply\n"+"format ".concat(n.binary?n.littleEndian?"binary_little_endian":"binary_big_endian":"ascii"," 1.0\n")+"element vertex ".concat(c,"\n")+"property float x\nproperty float y\nproperty float z\n";!0===a&&(d+="property float nx\nproperty float ny\nproperty float nz\n"),!0===u&&(d+="property float s\nproperty float t\n"),!0===l&&(d+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===f&&(d+="element face ".concat(s,"\n")+"property list uchar int vertex_index\n"),d+="end_header\n";var p=new r.Vector3,g=new r.Matrix3,y=null;if(!0===n.binary){var x=(new TextEncoder).encode(d),E=c*(12+(a?12:0)+(l?3:0)+(u?8:0)),b=f?13*s:0,h=new DataView(new ArrayBuffer(x.length+E+b));new Uint8Array(h.buffer).set(x,0);var m=x.length,v=x.length+E,A=0;o((function(t,e){var r=e.getAttribute("position"),o=e.getAttribute("normal"),i=e.getAttribute("uv"),c=e.getAttribute("color"),s=e.getIndex();g.getNormalMatrix(t.matrixWorld);for(var d=0,y=r.count;d<y;d++)p.x=r.getX(d),p.y=r.getY(d),p.z=r.getZ(d),p.applyMatrix4(t.matrixWorld),h.setFloat32(m,p.x,n.littleEndian),m+=4,h.setFloat32(m,p.y,n.littleEndian),m+=4,h.setFloat32(m,p.z,n.littleEndian),m+=4,!0===a&&(null!=o?(p.x=o.getX(d),p.y=o.getY(d),p.z=o.getZ(d),p.applyMatrix3(g).normalize(),h.setFloat32(m,p.x,n.littleEndian),m+=4,h.setFloat32(m,p.y,n.littleEndian),m+=4,h.setFloat32(m,p.z,n.littleEndian),m+=4):(h.setFloat32(m,0,n.littleEndian),m+=4,h.setFloat32(m,0,n.littleEndian),m+=4,h.setFloat32(m,0,n.littleEndian),m+=4)),!0===u&&(null!=i?(h.setFloat32(m,i.getX(d),n.littleEndian),m+=4,h.setFloat32(m,i.getY(d),n.littleEndian),m+=4):!1!==u&&(h.setFloat32(m,0,n.littleEndian),m+=4,h.setFloat32(m,0,n.littleEndian),m+=4)),!0===l&&(null!=c?(h.setUint8(m,Math.floor(255*c.getX(d))),m+=1,h.setUint8(m,Math.floor(255*c.getY(d))),m+=1,h.setUint8(m,Math.floor(255*c.getZ(d))),m+=1):(h.setUint8(m,255),m+=1,h.setUint8(m,255),m+=1,h.setUint8(m,255),m+=1));if(!0===f)if(null!==s)for(d=0,y=s.count;d<y;d+=3)h.setUint8(v,3),v+=1,h.setUint32(v,s.getX(d+0)+A,n.littleEndian),v+=4,h.setUint32(v,s.getX(d+1)+A,n.littleEndian),v+=4,h.setUint32(v,s.getX(d+2)+A,n.littleEndian),v+=4;else for(d=0,y=r.count;d<y;d+=3)h.setUint8(v,3),v+=1,h.setUint32(v,A+d,n.littleEndian),v+=4,h.setUint32(v,A+d+1,n.littleEndian),v+=4,h.setUint32(v,A+d+2,n.littleEndian),v+=4;A+=r.count})),y=h.buffer}else{A=0;var w="",M="";o((function(t,e){var n=e.getAttribute("position"),r=e.getAttribute("normal"),o=e.getAttribute("uv"),i=e.getAttribute("color"),c=e.getIndex();g.getNormalMatrix(t.matrixWorld);for(var d=0,y=n.count;d<y;d++){p.x=n.getX(d),p.y=n.getY(d),p.z=n.getZ(d),p.applyMatrix4(t.matrixWorld);var x=p.x+" "+p.y+" "+p.z;!0===a&&(null!=r?(p.x=r.getX(d),p.y=r.getY(d),p.z=r.getZ(d),p.applyMatrix3(g).normalize(),x+=" "+p.x+" "+p.y+" "+p.z):x+=" 0 0 0"),!0===u&&(null!=o?x+=" "+o.getX(d)+" "+o.getY(d):!1!==u&&(x+=" 0 0")),!0===l&&(x+=null!=i?" "+Math.floor(255*i.getX(d))+" "+Math.floor(255*i.getY(d))+" "+Math.floor(255*i.getZ(d)):" 255 255 255"),w+=x+"\n"}if(!0===f){if(null!==c)for(d=0,y=c.count;d<y;d+=3)M+="3 ".concat(c.getX(d+0)+A),M+=" ".concat(c.getX(d+1)+A),M+=" ".concat(c.getX(d+2)+A,"\n");else for(d=0,y=n.count;d<y;d+=3)M+="3 ".concat(A+d," ").concat(A+d+1," ").concat(A+d+2,"\n");s+=c?c.count/3:n.count/3}A+=n.count})),y="".concat(d).concat(w).concat(f?"".concat(M,"\n"):"\n")}return"function"===typeof e&&requestAnimationFrame((function(){return e(y)})),y}}}}]);
//# sourceMappingURL=PLYExporter.56ebb541.chunk.js.map