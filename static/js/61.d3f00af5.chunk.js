(this["webpackJsonpdl-model"]=this["webpackJsonpdl-model"]||[]).push([[61],{491:function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFExporter",(function(){return n}));var s=r(1),n=function(){function e(){this.pluginCallbacks=[],this.register((function(e){return new R(e)})),this.register((function(e){return new F(e)})),this.register((function(e){return new N(e)}))}e.prototype={constructor:e,register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,r){for(var s=new S,n=[],i=0,a=this.pluginCallbacks.length;i<a;i++)n.push(this.pluginCallbacks[i](s));s.setPlugins(n),s.write(e,t,r)}};var t=0,r=1,n=2,i=3,a=4,o=5121,l=5123,u=5126,h=5125,p=34962,c=34963,f=9728,m=9729,g=9984,d=9985,v=9986,b=9987,y=33071,x=33648,w=10497,T={};T[s.NearestFilter]=f,T[s.NearestMipmapNearestFilter]=g,T[s.NearestMipmapLinearFilter]=v,T[s.LinearFilter]=m,T[s.LinearMipmapNearestFilter]=d,T[s.LinearMipmapLinearFilter]=b,T[s.ClampToEdgeWrapping]=y,T[s.RepeatWrapping]=w,T[s.MirroredRepeatWrapping]=x;var M={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function A(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}function E(e){return 4*Math.ceil(e/4)}function I(e,t){t=t||0;var r=E(e.byteLength);if(r!==e.byteLength){var s=new Uint8Array(r);if(s.set(new Uint8Array(e)),0!==t)for(var n=e.byteLength;n<r;n++)s[n]=t;return s.buffer}return e}var L=null;function S(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}function R(e){this.writer=e,this.name="KHR_lights_punctual"}function F(e){this.writer=e,this.name="KHR_materials_unlit"}function N(e){this.writer=e,this.name="KHR_materials_pbrSpecularGlossiness"}return S.prototype={constructor:S,setPlugins:function(e){this.plugins=e},write:function(e,t,r){this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e);var s=this;Promise.all(this.pending).then((function(){var e,r=s.buffers,n=s.json,i=s.options,a=s.extensionsUsed,o=new Blob(r,{type:"application/octet-stream"}),l=Object.keys(a);(l.length>0&&(n.extensionsUsed=l),n.buffers&&n.buffers.length>0&&(n.buffers[0].byteLength=o.size),!0===i.binary)?((e=new window.FileReader).readAsArrayBuffer(o),e.onloadend=function(){var r=I(e.result),s=new DataView(new ArrayBuffer(8));s.setUint32(0,r.byteLength,!0),s.setUint32(4,5130562,!0);var i=I(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,s=e.length;r<s;r++){var n=e.charCodeAt(r);t[r]=n>255?32:n}return t.buffer}(JSON.stringify(n)),32),a=new DataView(new ArrayBuffer(8));a.setUint32(0,i.byteLength,!0),a.setUint32(4,1313821514,!0);var o=new ArrayBuffer(12),l=new DataView(o);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);var u=12+a.byteLength+i.byteLength+s.byteLength+r.byteLength;l.setUint32(8,u,!0);var h=new Blob([o,a,i,s,r],{type:"application/octet-stream"}),p=new window.FileReader;p.readAsArrayBuffer(h),p.onloadend=function(){t(p.result)}}):n.buffers&&n.buffers.length>0?((e=new window.FileReader).readAsDataURL(o),e.onloadend=function(){var r=e.result;n.buffers[0].uri=r,t(n)}):t(n)}))},serializeUserData:function(e,t){if(0!==Object.keys(e.userData).length){var r=this.options,s=this.extensionsUsed;try{var n=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&n.gltfExtensions){for(var i in void 0===t.extensions&&(t.extensions={}),n.gltfExtensions)t.extensions[i]=n.gltfExtensions[i],s[i]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(a){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+a.message)}}},getUID:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)},isNormalizedNormalAttribute:function(e){if(this.cache.attributesNormalized.has(e))return!1;for(var t=new s.Vector3,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0},createNormalizedNormalAttribute:function(e){var t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);for(var r=e.clone(),n=new s.Vector3,i=0,a=r.count;i<a;i++)n.fromBufferAttribute(r,i),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),r.setXYZ(i,n.x,n.y,n.z);return t.attributesNormalized.set(e,r),r},applyTextureTransform:function(e,t){var r=!1,s={};0===t.offset.x&&0===t.offset.y||(s.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(s.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(s.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)},processBuffer:function(e){var t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0},processBufferView:function(e,t,r,s,n){var i,a=this.json;a.bufferViews||(a.bufferViews=[]),i=t===o?1:t===l?2:4;for(var c=E(s*e.itemSize*i),f=new DataView(new ArrayBuffer(c)),m=0,g=r;g<r+s;g++)for(var d=0;d<e.itemSize;d++){var v;e.itemSize>4?v=e.array[g*e.itemSize+d]:0===d?v=e.getX(g):1===d?v=e.getY(g):2===d?v=e.getZ(g):3===d&&(v=e.getW(g)),t===u?f.setFloat32(m,v,!0):t===h?f.setUint32(m,v,!0):t===l?f.setUint16(m,v,!0):t===o&&f.setUint8(m,v),m+=i}var b={buffer:this.processBuffer(f.buffer),byteOffset:this.byteOffset,byteLength:c};return void 0!==n&&(b.target=n),n===p&&(b.byteStride=e.itemSize*i),this.byteOffset+=c,a.bufferViews.push(b),{id:a.bufferViews.length-1,byteLength:0}},processBufferViewImage:function(e){var t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise((function(s){var n=new window.FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){var e=I(n.result),i={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,s(r.bufferViews.push(i)-1)}}))},processAccessor:function(e,t,r,s){var n,i=this.options,a=this.json;if(e.array.constructor===Float32Array)n=u;else if(e.array.constructor===Uint32Array)n=h;else if(e.array.constructor===Uint16Array)n=l;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");n=o}if(void 0===r&&(r=0),void 0===s&&(s=e.count),i.truncateDrawRange&&void 0!==t&&null===t.index){var f=r+s,m=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;r=Math.max(r,t.drawRange.start),(s=Math.min(f,m)-r)<0&&(s=0)}if(0===s)return null;var g,d=function(e,t,r){for(var s={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},n=t;n<t+r;n++)for(var i=0;i<e.itemSize;i++){var a;e.itemSize>4?a=e.array[n*e.itemSize+i]:0===i?a=e.getX(n):1===i?a=e.getY(n):2===i?a=e.getZ(n):3===i&&(a=e.getW(n)),s.min[i]=Math.min(s.min[i],a),s.max[i]=Math.max(s.max[i],a)}return s}(e,r,s);void 0!==t&&(g=e===t.index?c:p);var v=this.processBufferView(e,n,r,s,g),b={bufferView:v.id,byteOffset:v.byteOffset,componentType:n,count:s,max:d.max,min:d.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(b.normalized=!0),a.accessors||(a.accessors=[]),a.accessors.push(b)-1},processImage:function(e,t,r){var n=this,i=n.cache,a=n.json,o=n.options,l=n.pending;i.images.has(e)||i.images.set(e,{});var u=i.images.get(e),h=t===s.RGBAFormat?"image/png":"image/jpeg",p=h+":flipY/"+r.toString();if(void 0!==u[p])return u[p];a.images||(a.images=[]);var c={mimeType:h};if(o.embedImages){var f=L=L||document.createElement("canvas");f.width=Math.min(e.width,o.maxTextureSize),f.height=Math.min(e.height,o.maxTextureSize);var m=f.getContext("2d");if(!0===r&&(m.translate(0,f.height),m.scale(1,-1)),"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap)m.drawImage(e,0,0,f.width,f.height);else{t!==s.RGBAFormat&&t!==s.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>o.maxTextureSize||e.height>o.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);var g=e.data;if(t===s.RGBFormat){g=new Uint8ClampedArray(e.height*e.width*4);for(var d=0,v=0;d<g.length;d+=4,v+=3)g[d+0]=e.data[v+0],g[d+1]=e.data[v+1],g[d+2]=e.data[v+2],g[d+3]=255}m.putImageData(new ImageData(g,e.width,e.height),0,0)}!0===o.binary?l.push(new Promise((function(e){f.toBlob((function(t){n.processBufferViewImage(t).then((function(t){c.bufferView=t,e()}))}),h)}))):c.uri=f.toDataURL(h)}else c.uri=e.src;var b=a.images.push(c)-1;return u[p]=b,b},processSampler:function(e){var t=this.json;t.samplers||(t.samplers=[]);var r={magFilter:T[e.magFilter],minFilter:T[e.minFilter],wrapS:T[e.wrapS],wrapT:T[e.wrapT]};return t.samplers.push(r)-1},processTexture:function(e){var t=this.cache,r=this.json;if(t.textures.has(e))return t.textures.get(e);r.textures||(r.textures=[]);var s={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(s.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,s)}));var n=r.textures.push(s)-1;return t.textures.set(e,n),n},processMaterial:function(e){var t=this.cache,r=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);var n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var i=e.color.toArray().concat([e.opacity]);if(A(i,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=i),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var a={index:this.processTexture(e.metalnessMap)};this.applyTextureTransform(a,e.metalnessMap),n.pbrMetallicRoughness.metallicRoughnessTexture=a}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:this.processTexture(e.map)};this.applyTextureTransform(o,e.map),n.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){var l=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(A(l,[0,0,0])||(n.emissiveFactor=l),e.emissiveMap){var u={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(u,e.emissiveMap),n.emissiveTexture=u}}if(e.normalMap){var h={index:this.processTexture(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),h.scale=e.normalScale.x),this.applyTextureTransform(h,e.normalMap),n.normalTexture=h}if(e.aoMap){var p={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(p.strength=e.aoMapIntensity),this.applyTextureTransform(p,e.aoMap),n.occlusionTexture=p}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===s.DoubleSide&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,n)}));var c=r.materials.push(n)-1;return t.materials.set(e,c),c},processMesh:function(e){var o=this.cache,l=this.json,u=[e.geometry.uuid];if(Array.isArray(e.material))for(var h=0,p=e.material.length;h<p;h++)u.push(e.material[h].uuid);else u.push(e.material.uuid);var c=u.join(":");if(o.meshes.has(c))return o.meshes.get(c);var f,m=e.geometry;if(f=e.isLineSegments?r:e.isLineLoop?n:e.isLine?i:e.isPoints?t:e.material.wireframe?r:a,!0!==m.isBufferGeometry)throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");var g={},d={},v=[],b=[],y={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},x=m.getAttribute("normal");void 0===x||this.isNormalizedNormalAttribute(x)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),m.setAttribute("normal",this.createNormalizedNormalAttribute(x)));var w=null;for(var T in m.attributes)if("morph"!==T.substr(0,5)){var M=m.attributes[T];T=y[T]||T.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(T)||(T="_"+T),o.attributes.has(this.getUID(M)))d[T]=o.attributes.get(this.getUID(M));else{w=null;var A=M.array;"JOINTS_0"!==T||A instanceof Uint16Array||A instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),w=new s.BufferAttribute(new Uint16Array(A),M.itemSize,M.normalized));var E=this.processAccessor(w||M,m);null!==E&&(d[T]=E,o.attributes.set(this.getUID(M),E))}}if(void 0!==x&&m.setAttribute("normal",x),0===Object.keys(d).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var I=[],L=[],S={};if(void 0!==e.morphTargetDictionary)for(var R in e.morphTargetDictionary)S[e.morphTargetDictionary[R]]=R;for(h=0;h<e.morphTargetInfluences.length;++h){var F={},N=!1;for(var T in m.morphAttributes)if("position"===T||"normal"===T){M=m.morphAttributes[T][h];var U=T.toUpperCase(),k=m.attributes[T];if(o.attributes.has(this.getUID(M)))F[U]=o.attributes.get(this.getUID(M));else{var B=M.clone();if(!m.morphTargetsRelative)for(var C=0,O=M.count;C<O;C++)B.setXYZ(C,M.getX(C)-k.getX(C),M.getY(C)-k.getY(C),M.getZ(C)-k.getZ(C));F[U]=this.processAccessor(B,m),o.attributes.set(this.getUID(k),F[U])}}else N||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),N=!0);b.push(F),I.push(e.morphTargetInfluences[h]),void 0!==e.morphTargetDictionary&&L.push(S[h])}g.weights=I,L.length>0&&(g.extras={},g.extras.targetNames=L)}var z=Array.isArray(e.material);if(z&&0===m.groups.length)return null;for(var D=z?e.material:[e.material],G=z?m.groups:[{materialIndex:0,start:void 0,count:void 0}],V=(h=0,G.length);h<V;h++){var _={mode:f,attributes:d};if(this.serializeUserData(m,_),b.length>0&&(_.targets=b),null!==m.index){var j=this.getUID(m.index);void 0===G[h].start&&void 0===G[h].count||(j+=":"+G[h].start+":"+G[h].count),o.attributes.has(j)?_.indices=o.attributes.get(j):(_.indices=this.processAccessor(m.index,m,G[h].start,G[h].count),o.attributes.set(j,_.indices)),null===_.indices&&delete _.indices}var H=this.processMaterial(D[G[h].materialIndex]);null!==H&&(_.material=H),v.push(_)}g.primitives=v,l.meshes||(l.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,g)}));var P=l.meshes.push(g)-1;return o.meshes.set(c,P),P},processCamera:function(e){var t=this.json;t.cameras||(t.cameras=[]);var r=e.isOrthographicCamera,n={type:r?"orthographic":"perspective"};return r?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:s.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),t.cameras.push(n)-1},processAnimation:function(t,r){var n=this.json,i=this.nodeMap;n.animations||(n.animations=[]);for(var a=(t=e.Utils.mergeMorphTargetTracks(t.clone(),r)).tracks,o=[],l=[],u=0;u<a.length;++u){var h=a[u],p=s.PropertyBinding.parseTrackName(h.name),c=s.PropertyBinding.findNode(r,p.nodeName),f=M[p.propertyName];if("bones"===p.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(p.objectIndex):void 0),!c||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',h.name),null;var m,g=h.values.length/h.times.length;f===M.morphTargetInfluences&&(g/=c.morphTargetInfluences.length),!0===h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(m="CUBICSPLINE",g/=3):m=h.getInterpolation()===s.InterpolateDiscrete?"STEP":"LINEAR",l.push({input:this.processAccessor(new s.BufferAttribute(h.times,1)),output:this.processAccessor(new s.BufferAttribute(h.values,g)),interpolation:m}),o.push({sampler:l.length-1,target:{node:i.get(c),path:f}})}return n.animations.push({name:t.name||"clip_"+n.animations.length,samplers:l,channels:o}),n.animations.length-1},processSkin:function(e){var t=this.json,r=this.nodeMap,n=t.nodes[r.get(e)],i=e.skeleton;if(void 0===i)return null;var a=e.skeleton.bones[0];if(void 0===a)return null;for(var o=[],l=new Float32Array(16*i.bones.length),u=new s.Matrix4,h=0;h<i.bones.length;++h)o.push(r.get(i.bones[h])),u.copy(i.boneInverses[h]),u.multiply(e.bindMatrix).toArray(l,16*h);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new s.BufferAttribute(l,16)),joints:o,skeleton:r.get(a)}),n.skin=t.skins.length-1},processNode:function(e){var t=this.json,r=this.options,s=this.nodeMap;t.nodes||(t.nodes=[]);var n={};if(r.trs){var i=e.quaternion.toArray(),a=e.position.toArray(),o=e.scale.toArray();A(i,[0,0,0,1])||(n.rotation=i),A(a,[0,0,0])||(n.translation=a),A(o,[1,1,1])||(n.scale=o)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===A(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(n.matrix=e.matrix.elements);if(""!==e.name&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){var l=this.processMesh(e);null!==l&&(n.mesh=l)}else e.isCamera&&(n.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){for(var u=[],h=0,p=e.children.length;h<p;h++){var c=e.children[h];if(c.visible||!1===r.onlyVisible)null!==(f=this.processNode(c))&&u.push(f)}u.length>0&&(n.children=u)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,n)}));var f=t.nodes.push(n)-1;return s.set(e,f),f},processScene:function(e){var t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);var s={};""!==e.name&&(s.name=e.name),t.scenes.push(s);for(var n=[],i=0,a=e.children.length;i<a;i++){var o=e.children[i];if(o.visible||!1===r.onlyVisible){var l=this.processNode(o);null!==l&&n.push(l)}}n.length>0&&(s.nodes=n),this.serializeUserData(e,s)},processObjects:function(e){var t=new s.Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);this.processScene(t)},processInput:function(e){var t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));for(var r=[],n=0;n<e.length;n++)e[n]instanceof s.Scene?this.processScene(e[n]):r.push(e[n]);r.length>0&&this.processObjects(r);for(n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))},_invokeAll:function(e){for(var t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}},R.prototype={constructor:R,writeNode:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var r=this.writer,s=r.json,n=r.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,i.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},n[this.name]=!0);var a=s.extensions[this.name].lights;a.push(i),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}},F.prototype={constructor:F,writeMaterial:function(e,t){if(e.isMeshBasicMaterial){var r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}},N.prototype={constructor:N,writeMaterial:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var r=this.writer,s=r.extensionsUsed,n={};t.pbrMetallicRoughness.baseColorFactor&&(n.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var i=[1,1,1];if(e.specular.toArray(i,0),n.specularFactor=i,n.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(n.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var a={index:r.processTexture(e.specularMap)};r.applyTextureTransform(a,e.specularMap),n.specularGlossinessTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}}},e.Utils={insertKeyframe:function(e,t){var r,s=.001,n=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),a=new e.ValueBufferType(e.values.length+n),o=e.createInterpolant(new e.ValueBufferType(n));if(0===e.times.length){i[0]=t;for(var l=0;l<n;l++)a[l]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<s)return 0;i[0]=t,i.set(e.times,1),a.set(o.evaluate(t),0),a.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<s)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),a.set(e.values,0),a.set(o.evaluate(t),e.values.length),r=i.length-1}else for(l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<s)return l;if(e.times[l]<t&&e.times[l+1]>t){i.set(e.times.slice(0,l+1),0),i[l+1]=t,i.set(e.times.slice(l+1),l+2),a.set(e.values.slice(0,(l+1)*n),0),a.set(o.evaluate(t),(l+1)*n),a.set(e.values.slice((l+1)*n),(l+2)*n),r=l+1;break}}return e.times=i,e.values=a,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},i=e.tracks,a=0;a<i.length;++a){var o=i[a],l=s.PropertyBinding.parseTrackName(o.name),u=s.PropertyBinding.findNode(t,l.nodeName);if("morphTargetInfluences"===l.propertyName&&void 0!==l.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(s.InterpolateLinear)}var h,p=u.morphTargetInfluences.length,c=u.morphTargetDictionary[l.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);if(void 0!==n[u.uuid]){var f=o.createInterpolant(new o.ValueBufferType(1));h=n[u.uuid];for(d=0;d<h.times.length;d++)h.values[d*p+c]=f.evaluate(h.times[d]);for(d=0;d<o.times.length;d++){var m=this.insertKeyframe(h,o.times[d]);h.values[m*p+c]=o.values[d]}}else{for(var g=new((h=o.clone()).ValueBufferType)(p*h.times.length),d=0;d<h.times.length;d++)g[d*p+c]=h.values[d];h.name=(l.nodeName||"")+".morphTargetInfluences",h.values=g,n[u.uuid]=h,r.push(h)}}else r.push(o)}return e.tracks=r,e}},e}()}}]);
//# sourceMappingURL=61.d3f00af5.chunk.js.map