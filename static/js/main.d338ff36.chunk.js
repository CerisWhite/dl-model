(this["webpackJsonpdl-model"]=this["webpackJsonpdl-model"]||[]).push([[8],{17:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(13),r=n(8),i=n(11),o=n(1),c=n(10),u=n(6),s=function(e,t){var n=t.type,a=t.key,i=t.subkey,o=t.value;switch(n){case"toggle":var s;return i?(s=e[a][i][o],Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),{},Object(c.a)({},i,Object(r.a)(Object(r.a)({},e[a][i]),{},Object(c.a)({},o,!s))))))):(s=e[a][o],Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),{},Object(c.a)({},o,!s)))));case"reset":var l=i?u.s[a][i]:u.s[a];if(!o)return i?Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),{},Object(c.a)({},i,Object(r.a)(Object(r.a)({},e[a][i]),l))))):Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),l)));var d={};return o.forEach((function(e){d[e]=l[e]})),i?Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),{},Object(c.a)({},i,Object(r.a)(Object(r.a)({},e[a][i]),d))))):Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),d)));case"load":return;case"update":return i?Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),{},Object(c.a)({},i,Object(r.a)(Object(r.a)({},e[a][i]),o))))):Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},a,Object(r.a)(Object(r.a)({},e[a]),o)));default:return e}},l=n(9),d=Object(o.createContext)(),f=Object(o.createContext)(),p={chainMaker:{chain:Object(l.j)(u.s.animation.code,"init")}};function m(e){var t=Object(o.useReducer)(s,p),n=Object(a.a)(t,2),r=n[0],c=n[1];return Object(i.jsx)(d.Provider,{value:r,children:Object(i.jsx)(f.Provider,{value:c,children:e.children})})}Object.keys(u.s).forEach((function(e){return p[e]=Object(r.a)({},u.s[e])})),p.scene.lights=u.s.scene.lights.map((function(e){return Object(r.a)({},e)}))},26:function(e,t,n){"use strict";n.d(t,"m",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"o",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"a",(function(){return g})),n.d(t,"j",(function(){return j})),n.d(t,"l",(function(){return y})),n.d(t,"f",(function(){return x})),n.d(t,"i",(function(){return O})),n.d(t,"e",(function(){return w})),n.d(t,"g",(function(){return k})),n.d(t,"h",(function(){return _}));var a=n(50),r=n(11),i=n(82),o=n(17),c=n(6),u=n(9),s=function(e){return e.startsWith("w302")},l=function(e,t){Array.isArray(e)?e.forEach((function(e){return t(e)})):t(e)},d=function(e){if(0!==e.length){var t=!1,n=!1;e.forEach((function(e){if(e){var r=e.split("="),i=Object(a.a)(r),s=i[0],l=i.slice(1);if(l[0]){var d=1===l.length?l[0]:l.join("=");switch(s){case"et":t=!0;break;case"mt":n=!0;break;case"cc":var f=Object(u.j)(d,"Animation");o.d.chainMaker.chain=f;break;case"bg":"transparent"!==d&&(d="#".concat(d));break;case"cam":d=d.split(",").map((function(e){return parseFloat(e)}))}var p=c.v[s],m=p.group,h=p.key,b="true"===d||"false"===d;o.d[m][h]=b?Boolean("true"===d):d}}})),o.d.model.texture=o.d.model.id,t||(o.d.model.eyeTexture=o.d.model.id),n||(o.d.model.mouthTexture=o.d.model.id)}},f=function(e){var t=e.length,n="";return e.forEach((function(a,r){var i=a.fileName,o=a.aniName,c=a.faceChanges;i&&(n=(n=0===r?n.concat(i):n.concat(i!==e[r-1].fileName?i:"")).concat("+")),n=n.concat(o);var u=p(a);n=n.concat(u);var s=m(c);n=n.concat(s),r<t-1&&(n=n.concat(">"))})),n},p=function(e){var t="";return Object.keys(c.m).forEach((function(n){var a=c.m[n],r=a.key,i=a.defaultValue;e[r]!==i&&(t=t.concat("&".concat(n,"=").concat(e[r])))})),t},m=function(e){if(!e)return"";var t="";return e.forEach((function(e){var n=e.time,a=e.eyeIdx,r=e.mouthIdx;n&&(a&&(t=t.concat("&e-".concat(n,"=").concat(a))),r&&(t=t.concat("&m-".concat(n,"=").concat(r))))})),t},h=function(e){var t={};return Object.keys(e).forEach((function(n){var a=[];Object.keys(e[n]).forEach((function(t){e[n][t]&&a.push(t)})),t[n]=a})),t},b=function(e,t){var n=Object.keys(t);return e.filter((function(e){return n.every((function(n){return!t[n].length||t[n].includes(e[n])}))}))},v=function(e){var t,n=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(e);return(299*(t=n).r+587*t.g+114*t.b)/1e3>128?"#000000":"#ffffff"},g=function(e,t,n){if(!e)return null;var a={maxWidth:"13.5rem"};return Object.keys(e).map((function(o){return Object(r.jsx)(i.a,{variant:"contained","data-value":e[o],"data-name":"".concat(n?"".concat(n," "):"").concat(o),onClick:t,style:a,children:o},o)}))},j=function(e,t){return"LOB_".concat(c.j[e],"+").concat(c.j[e],"_ONT_").concat(c.h[t])},y=function(e){return"WIN_".concat(c.j[e],"+").concat(c.j[e],"_WIN_01>+").concat(c.j[e],"_WIN_02")},x=function(e){return"DAS+".concat(c.j[e],"_DAS_02")},O=function(e){return"ROL+".concat(c.j[e],"_ROL_01")},w=function(e){for(var t=c.b[e],n=c.j[e],a="CMB_".concat(n),r=1;r<=t;r++)a=a.concat("+".concat(n,"_CMB_0").concat(r,">"));return a=a.slice(0,-1)},k=function(e){for(var t=c.g[e],n=c.j[e],a="FS_".concat(n),r=1;r<=t;r++)a=a.concat("+".concat(n,"_CHR_0").concat(r,">"));return a=a.slice(0,-1)},_=function(e,t){var n=c.j[e];return"Male"===t?"LOB_".concat(n,"+").concat(n,"_ONT_05&ts=-0.5>+").concat(n,"_ONT_02>+").concat(n,"_ONT_07>+").concat(n,"_ONT_08>+").concat(n,"_ONT_21"):"LOB_".concat(n,"+").concat(n,"_ONT_06&ts=-0.5>+").concat(n,"_ONT_04>+").concat(n,"_ONT_09>+").concat(n,"_ONT_10>+").concat(n,"_ONT_23")}},39:function(e,t,n){"use strict";n.d(t,"b",(function(){return R}));var a=n(8),r=n(11),i=n(17),o=n(54),c=n(14),u=n(13),s=n(1),l=n(56),d=n(75),f=n.n(d),p=n(120),m=n(70),h=n(44),b=n(32),v=n(15),g=n.n(v),j=n(29),y=n(3),x=n(7),O=n(27),w=n(4),k=n(5),_=n(0),A=n(74),M=n(6),I=n(9),S=n(26),C=["Right","Left"],T=function(e){Object(w.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(y.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).initialize=Object(j.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.props.setIsLoading(!0),e.initScene(),t.next=4,e.loadModels();case 4:e.props.setIsLoading(!1),e.initAnimation();case 6:case"end":return t.stop()}}),t)}))),e.initScene=function(){var t,n;e.viewport=e.props.viewport||{width:window.innerWidth,height:window.innerHeight},e.clock=new _.Clock,e.scene=new _.Scene,e.bgColor=e.props.bgColor,e.floor=Object(I.m)(),e.scene.add(e.floor),e.camera=new _.PerspectiveCamera(M.a.angle,e.viewport.width/e.viewport.height,M.a.near,M.a.far),e.cameraPosition=e.props.cameraPosition||[2,0,10],(t=e.camera.position).set.apply(t,Object(b.a)(e.cameraPosition)),e.camera.updateProjectionMatrix(),e.controls=new A.a(e.camera,e.mount),e.controlsPosition=e.props.controlsPosition||[0,0,0],(n=e.controls.target).set.apply(n,Object(b.a)(e.controlsPosition)),e.controls.update();var a=e.props.lights;e.addLights(a),e.loadedFX=new Map,e.rendererAA=new _.WebGLRenderer({antialias:!0,alpha:!0}),e.rendererAA.outputEncoding=_.sRGBEncoding,e.rendererNoAA=new _.WebGLRenderer({antialias:!1,alpha:!0}),e.rendererNoAA.outputEncoding=_.sRGBEncoding;var r=e.props.antiAliasing;e._AA=r,e.renderer=r?e.rendererAA:e.rendererNoAA,e.finalRenderer=e.renderer,e.canvas=e.finalRenderer.domElement,e.finalRenderer.setSize(e.viewport.width,e.viewport.height),e.mount.appendChild(e.canvas),e.animate()},e.loadModels=Object(j.a)(g.a.mark((function t(){var n,a,r,i,o,c,s,l,d;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.models={},e.modelInfo={main:e.props.model.id,weaponLeft:Object(I.b)(e.props.model.weaponLeft),weaponRight:Object(I.b)(e.props.model.weaponRight)},e.materials=[],e.outlines={},t.next=6,e.initModelsLoad();case 6:if(n=t.sent,a=Object(u.a)(n,3),r=a[0],i=a[1],o=a[2],e.models={main:r,weaponRight:i,weaponLeft:o},c=e.props.model.id,!Object(I.v)(c)){t.next=18;break}return Object(S.m)(c)&&(s=e.props.model.materialType,l=Object(I.b)("".concat(c,"n")),d=l.texturePath,Object(I.k)(r,{materialType:s,texturePath:d})),e.basicMainProcessing(),Object(I.u)(c)&&Object(I.t)(r),t.abrupt("return");case 18:e.initAllModels();case 19:case"end":return t.stop()}}),t)}))),e.initAnimation=function(){var t=e.props.model.id;Object(I.v)(t)||e.addAnimation()},e.addLights=function(t){e.lights=[],t.forEach((function(t){var n,a=t.enable,r=t.type,i=t.color,o=t.intensity,c=Object(h.a)(t,["enable","type","color","intensity"]);if(a){for(var s="".concat(r,"Light"),l=new _[s](i,o),d=0,f=Object.entries(c);d<f.length;d++){var p=Object(u.a)(f[d],2),m=p[0],v=p[1];switch(m){case"position":var g=v.map((function(e){return e||0}));(n=l.position).set.apply(n,Object(b.a)(g));break;default:l[m]=v}}e.scene.add(l),e.lights.push(l)}}))},e.removeLights=function(){return e.lights.forEach((function(t){return e.scene.remove(t)}))},e.initModelsLoad=function(){var t,n,a=e.modelInfo.main,r=Object(I.r)(a),i=Object(I.w)(r),o=null===(t=e.modelInfo.weaponRight)||void 0===t?void 0:t.modelPath,c=Object(I.w)(o),u=null===(n=e.modelInfo.weaponLeft)||void 0===n?void 0:n.modelPath,s=Object(I.w)(u);return Promise.all([i,c,s])},e.addToScene=function(t){return e.floor.add(t)},e.basicMainProcessing=function(){var t=e.models.main,n=e.props.outline;e.outlines.main=Object(I.n)(t,n);var a=e.props.model.materialType;Object(I.k)(t,{materialType:a,forced:!0}),e.addToScene(t)},e.initFace=function(){var t=e.props.model.id;e._eyeIdx=e._mouthIdx=M.c;var n={mouthTexture:t,mouthIdx:M.c,eyeTexture:t,eyeIdx:M.c};e.updateFace(n,e.props.model)},e.initMainModel=function(){e.basicMainProcessing(),e.initFace();var t=e.models.main;t.initPos=t.position.clone(),t.initRot=t.rotation.clone()},e.initAllModels=function(){e.initMainModel(),e.initAllWeapons(),e.attachAllWeapons(),e.applyMaterialSettings()},e.initAllWeapons=function(){var t=e.props.model.materialType;C.forEach((function(n){var a="weapon".concat(n),r=e.models[a];if(r){var i=e.modelInfo[a],o=i.texturePath,c=i.flipped;Object(I.k)(r,{materialType:t,texturePath:o}),c&&(r.rotation.y+=Math.PI);var u=e.props.outline;e.outlines[a]=Object(I.n)(r,u)}}))},e.attachWeapon=function(t,n){var a="jWeapon".concat(n[0]);e.models.main.traverse((function(e){e.name.includes(a)&&0===e.children.length&&e.add(t)}))},e.attachAllWeapons=function(){C.forEach((function(t){var n="weapon".concat(t),a=e.models[n];a&&e.attachWeapon(a,t)}))},e.detachWeapon=function(t){var n="weapon".concat(t),a=e.models[n];a&&a.parent.remove(a)},e.detachAllWeapons=function(){return C.forEach((function(t){return e.detachWeapon(t)}))},e.playNextAni=function(){var t=Object(O.a)(e).nAni;e.props.capture.enable&&e._aniIdx===t-1&&(e.mediaRecorder.stop(),e.props.toggleCapture());var n=(e._aniIdx+1)%t;e.aniIdx=n},e.addAnimation=Object(j.a)(g.a.mark((function t(){var n,a,r,i,o,c,s,l,d,f;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props.animation,a=n.code,r=n.timeScale,a){t.next=3;break}return t.abrupt("return");case 3:return e.props.setIsLoading(!0),i=e.models.main,o=Object(I.a)(a),c=Object(u.a)(o,2),s=c[0],l=c[1],e.nAni=l.length,i.mixer=new _.AnimationMixer(i),e.mixer=i.mixer,e._aniIdx=0,i.mixer.timeScale=r,i.mixer.addEventListener("finished",e.playNextAni),e.aniSettings=l.map((function(e){return{timeScale:e.timeScale,repetitions:e.repetitions,faceChanges:e.faceChanges}})),d=s.map((function(e){var t="".concat(R,"/fbx/").concat(e,".fbx");return Object(I.w)(t)})),t.next=16,Promise.all(d);case 16:f=t.sent,e.animations=[],l.forEach((function(t){var n=t.fileIdx,a=t.aniName,r=a?f[n].animations.find((function(e){return e.name===a})):f[n].animations[0];e.animations.push(r)})),e.aniIdx=0,e.props.setIsLoading(!1);case 21:case"end":return t.stop()}}),t)}))),e.removeAnimation=function(){var t=e.models.main;t.mixer.stopAllAction();var n=t.initPos,a=t.initRot;t.position.copy(n),t.rotation.copy(a),e.mixer=null,e.animations=[]},e.resetFace=function(){var t=e.props.model,n=t.eyeIdx,a=t.mouthIdx;e.eyeIdx=n,e.mouthIdx=a},e.updateViewport=function(t,n){var a=n.width,r=n.height;t.width===a&&t.height===r||(e.finalRenderer.setSize(a,r),e.camera.aspect=a/r,e.camera.updateProjectionMatrix())},e.captureAnimation=function(){e.chunks=[],e.videoStream=e.canvas.captureStream(30),e.mediaRecorder||(e.mediaRecorder=new MediaRecorder(e.videoStream,{mimeType:e.props.capture.codec}),e.mediaRecorder.ondataavailable=function(t){return e.chunks.push(t.data)},e.mediaRecorder.onstop=function(){e.props.setIsLoading(!1);var t=new Blob(e.chunks,{type:"video/webm"}),n=URL.createObjectURL(t),a=document.createElement("a");a.style="display: none",a.href=n,a.download="animation.webm",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)}),e.props.setIsLoading(!0);var t=e.props.model,n=t.eyeIdx,a=t.mouthIdx;e.eyeIdx=n,e.mouthIdx=a,e.aniIdx=0,e.mediaRecorder.start()},e.updateEyeTexture=function(t,n){var a=n.eyeTexture,r=t.eyeTexture;if(a===r)return!1;var i=n.materialType;Object(I.d)(e.models.main,{materialType:i,textureId:a});var o=Object(I.i)(a,r);return Object(I.c)(e.models.main,o),!0},e.updateMouthTexture=function(t,n){var a=n.mouthTexture,r=t.mouthTexture;if(a===r)return!1;var i=n.materialType;Object(I.f)(e.models.main,{materialType:i,textureId:a});var o=Object(I.i)(a,r);return Object(I.e)(e.models.main,o),!0},e.updateFaceTexture=function(t,n){var a=e.updateEyeTexture(t,n),r=e.updateMouthTexture(t,n);(a||r)&&e.applyMaterialSettings()},e.updateFaceOffset=function(t){var n=t.eyeIdx,a=t.mouthIdx;e.eyeIdx=n,e.mouthIdx=a},e.updateFace=function(t,n){e.updateFaceTexture(t,n),e.updateFaceOffset(n)},e.disposeMainModel=function(){var t=e.models.main;e.floor.remove(t),Object(I.o)(t)},e.updateMainModel=function(){var t=Object(j.a)(g.a.mark((function t(n,a){var r,i,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.id,n.id===r){t.next=17;break}return e.props.setIsLoading(!0),e.modelInfo.main=r,i=Object(I.r)(r),t.next=7,Object(I.w)(i);case 7:return o=t.sent,e.detachAllWeapons(),e.disposeMainModel(),e.models.main=o,e.initMainModel(),e.attachAllWeapons(),e.applyMaterialSettings(),e.addAnimation(),e.props.setIsLoading(!1),t.abrupt("return");case 17:e.updateFace(n,a);case 18:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.updateWeapons=function(){var t=Object(j.a)(g.a.mark((function t(n,a){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.setIsLoading(!0),C.forEach(function(){var t=Object(j.a)(g.a.mark((function t(r){var i,o,c,u,s,l,d,f;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i="weapon".concat(r),n[i]!==a[i]){t.next=3;break}return t.abrupt("return");case 3:if(e.detachWeapon(r),Object(I.o)(e.models[i]),a[i]){t.next=10;break}return e.models[i]=null,e.modelInfo[i]="",e.outlines[i]=null,t.abrupt("return");case 10:return e.modelInfo[i]=Object(I.b)(e.props.model[i]),o=e.modelInfo[i],c=o.modelPath,u=o.texturePath,s=o.flipped,t.next=14,Object(I.w)(c);case 14:l=t.sent,e.models[i]=l,d=a.materialType,Object(I.k)(l,{materialType:d,texturePath:u}),e.applyMaterialSettings(),s&&(l.rotation.y+=Math.PI),f=e.props.outline,e.outlines[i]=Object(I.n)(l,f),e.attachWeapon(l,r);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.props.setIsLoading(!1);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.updateModel=function(){var t=Object(j.a)(g.a.mark((function t(n,a){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object.keys(n).some((function(e){return n[e]!==a[e]}))){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.updateMainModel(n,a);case 5:e.updateWeapons(n,a);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.updateAnimation=function(t,n){var a=n.code,r=n.timeScale;if(t.code!==a)return t.code&&(e.removeAnimation(),e.resetFace()),void e.addAnimation();t.timeScale!==r&&(e.mixer.timeScale=r)},e.updateOutlineParams=function(t){Object.values(e.outlines).flat().forEach((function(e){Object(I.g)(e,t)}))},e.updateOutline=function(t,n){if(t!==n){var a=Object.keys(n).filter((function(e){return t[e]!==n[e]}));if(0!==a.length){var r=new Map(a.map((function(e){return[e,n[e]]})));e.updateOutlineParams(r)}}},e.saveMaterialReference=function(){var t=e.models.main;e.materials=Object(I.q)(t)},e.forEachMaterial=function(t){return e.materials.forEach((function(e){return t(e)}))},e.applyMaterialParams=function(){var t=e.props.model.materialType,n=e.props.materialParams,a=n.useTexture,r=n.flatShading,i=n.gradientMap,o=Object(I.s)(t),c=function(e){return o.includes(e)},u=M.y.filter(c),s=M.w.filter(c);if("Toon"===t&&"none"!==i){var l=parseInt(i),d=Object(I.l)(l);e.forEachMaterial((function(e){e.gradientMap=d,e.needsUpdate=!0}))}e.forEachMaterial((function(e){u.forEach((function(t){return e[t]=n[t]})),s.forEach((function(t){var a=n[t];e[t]=new _.Color(a)})),a?e.backupMap&&(e.map=e.backupMap,delete e.backupMap):(e.map&&!e.backupMap&&(e.backupMap=e.map),e.map=null),r&&(e.flatShading=n.flatShading,e.needsUpdate=!0)}))},e.applyMaterialSettings=function(){e.saveMaterialReference(),e.applyMaterialParams()},e.updateMaterialParams=function(t,n){var a=e.props.model.materialType,r=n.useTexture,i=n.flatShading,o=n.gradientMap,c=Object(I.s)(a).filter((function(e){return t[e]!==n[e]})),u=function(e){return c.includes(e)};if(M.y.filter(u).forEach((function(t){e.forEachMaterial((function(e){return e[t]=n[t]}))})),M.w.filter(u).forEach((function(t){var a=n[t],r=new _.Color(a);e.forEachMaterial((function(e){return e[t]=r}))})),t.useTexture!==r&&e.forEachMaterial((function(e){r?(e.map=e.backupMap,delete e.backupMap):(e.backupMap=e.map,e.map=null),e.needsUpdate=!0})),t.flatShading!==i&&e.forEachMaterial((function(e){e.flatShading=i,e.needsUpdate=!0})),t.gradientMap!==o){var s=null;if("none"!==o){var l=parseInt(o);s=Object(I.l)(l)}e.forEachMaterial((function(e){e.gradientMap=s,e.needsUpdate=!0}))}},e.updateMaterial=function(t,n){var a=n.model.materialType;if(t.model.materialType!==a)return Object(I.k)(e.models.main,{materialType:a}),void e.applyMaterialSettings();e.updateMaterialParams(t.materialParams,n.materialParams)},e.updateLights=function(t,n){t!==n&&(e.removeLights(),e.addLights(n))},e.updateAscii=function(){var t=Object(j.a)(g.a.mark((function t(a,r){var i,o,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object.keys(a).some((function(e){return a[e]!==r[e]}))){t.next=3;break}return t.abrupt("return");case 3:if(r.enable){t.next=9;break}return e.finalRenderer=e.renderer,i=e.renderer.domElement,e.setCanvas(i),t.abrupt("return");case 9:if(e.loadedFX.has("ascii")){t.next=18;break}return t.next=12,n.e(44).then(n.bind(null,446));case 12:o=t.sent,c=o.AsciiEffect,e.loadedFX.set("ascii",c),e.showAscii(),t.next=19;break;case 18:e.showAscii();case 19:e.finalRenderer.setSize(e.viewport.width,e.viewport.height);case 20:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.showAscii=function(){var t=e.props.ascii,n=t.charSet,a=t.color,r=t.bgColor,i=t.invert,o=e.loadedFX.get("ascii");e.effect=new o(e.renderer,n,{invert:i}),e.effect.setSize(e.viewport.width,e.viewport.height);var c=e.effect.domElement;c.style.color=a,c.style.background=r,e.setCanvas(c),e.finalRenderer=e.effect},e.setCanvas=function(t){var n=Object(O.a)(e).canvas;e.mount.removeChild(n),e.mount.appendChild(t),e.canvas=t},e.rotateFloor=function(t){var n=e.props.rotateSpeed,a=n*t*Math.PI/2;n&&e.floor.rotateY(a)},e.animate=function(){e.frameId=requestAnimationFrame(e.animate);var t=e.clock.getDelta();if((e.rotateFloor(t),e.mixer&&e.mixer.update(t),e.faceChanges&&e.faceChanges.length)&&e.mixer.time>=e.faceChangeTime[0]){e.faceChangeTime.shift();var n=e.faceChanges.shift(),a=n.eyeIdx,r=n.mouthIdx;e.eyeIdx=a,e.mouthIdx=r}e.finalRenderer.render(e.scene,e.camera)},e}return Object(x.a)(a,[{key:"componentDidMount",value:function(){window.app=this,this.initialize()}},{key:"componentDidUpdate",value:function(){var e=Object(j.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props,this.updateViewport(t.viewport,n.viewport),this.updateModel(t.model,n.model),this.updateAnimation(t.animation,n.animation),this.updateOutline(t.outline,n.outline),this.updateMaterial(t,n),this.updateLights(t.lights,n.lights),this.updateAscii(t.ascii,n.ascii),t.bgColor!==n.bgColor&&(this.bgColor=n.bgColor),n.capture.enable&&!t.capture.enable&&this.captureAnimation(),this.AA=n.antiAliasing;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.frameId),Object(I.o)(this.scene),this.mixer=null,this.clock=null,this.camera=null,this.controls=null,this.scene=null,this.renderer=null,this.rendererAA.renderLists.dispose(),this.rendererAA.dispose(),this.rendererAA=null,this.rendererNoAA.renderLists.dispose(),this.rendererNoAA.dispose(),this.rendererNoAA=null}},{key:"render",value:function(){var e=this;return Object(r.jsx)("div",{ref:function(t){e.mount=t}})}},{key:"AA",set:function(e){if(e!==this._AA){this._AA=e;var t=new _.Vector2;if(this.renderer.getSize(t),this.renderer=e?this.rendererAA:this.rendererNoAA,this.renderer.setSize(t.x,t.y),!this.props.ascii.enable){this.finalRenderer=this.renderer;var n=this.renderer.domElement;this.setCanvas(n)}}}},{key:"aniIdx",set:function(e){var t=this;this._aniIdx=e;var n=this.mixer;n.stopAllAction();var a=this.animations[e],r=n.clipAction(a),i=this.aniSettings[e],o=i.timeScale,c=i.repetitions,u=i.faceChanges;r.setLoop(_.LoopRepeat,c),r.clampWhenFinished=!0,r.timeScale=o,r.time=0,this.faceChanges=Object(I.p)(u,c),this.faceChangeTime=this.faceChanges.map((function(e){return t.currentClipDuration*e.time/100})),n.setTime(0),this.currentClipDuration=a.duration,r.play()}},{key:"eyeIdx",set:function(e){if(e){var t=this._eyeIdx;if(e!==t){var n=Object(I.h)(e,t);Object(I.c)(this.models.main,n),this._eyeIdx=e}}}},{key:"mouthIdx",set:function(e){if(e){var t=this._mouthIdx;if(e!==t){var n=Object(I.h)(e,t);Object(I.e)(this.models.main,n),this._mouthIdx=e}}}},{key:"bgColor",set:function(e){this.scene.background="transparent"!==e?new _.Color(e):null}}]),a}(s.PureComponent),L=(n(94),Object(s.lazy)((function(){return Promise.all([n.e(2),n.e(26)]).then(n.bind(null,445))})));var E=function(e){var t=e.viewport,n=Object(s.useContext)(i.b),a=n.model.id,o=n.scene,c=o.rotateSpeed,u=o.background,l=o.initCameraPosition,d=o.lights,f=n.app,p=f.showAniControl,m=f.antiAliasing,h=Object(s.useContext)(i.a),b=Object(s.useCallback)((function(){h({type:"toggle",key:"capture",value:"enable"})}),[h]),v=a[0],g=M.p[a]||M.p[v],j=l?l.map((function(e,t){return isNaN(e)?g[t]:e})):g,y=M.r[a]||M.r[v];return Object(r.jsxs)("div",{className:"Display",children:[p&&Object(r.jsx)("div",{className:"Display-AniControl",style:{color:Object(S.k)(u)},children:Object(r.jsx)(s.Suspense,{fallback:null,children:Object(r.jsx)(L,{value:n.animation.timeScale})})}),Object(r.jsx)(T,{setIsLoading:e.setIsLoading,capture:n.capture,toggleCapture:b,viewport:t,cameraPosition:j,controlsPosition:y,model:n.model,materialParams:n.materialParams,outline:n.outline,animation:n.animation,rotateSpeed:c,lights:d,bgColor:u,antiAliasing:m,ascii:n.ascii})]})},P=Object(s.lazy)((function(){return Promise.all([n.e(4),n.e(13),n.e(12)]).then(n.bind(null,457))})),N=Object(s.lazy)((function(){return Promise.all([n.e(4),n.e(25),n.e(42)]).then(n.bind(null,465))}));var W=function(e){var t=e.location,n=Object(m.a)(),a=Object(s.useState)("model"),o=Object(u.a)(a,2),c=o[0],d=o[1],h=Object(l.a)(!0),b=Object(u.a)(h,2),v=b[0],g=b[1],j=Object(l.a)(!1),y=Object(u.a)(j,2),x=y[0],O=y[1],w=Object(s.useState)(!1),k=Object(u.a)(w,2),_=k[0],A=k[1],M=Object(s.useState)(!1),I=Object(u.a)(M,2),C=I[0],T=I[1],L=Object(s.useRef)(null),W=Object(s.useContext)(i.b).app.showSettings,R=Object(s.useRef)(),B=Object(s.useState)({width:window.innerWidth,height:window.innerHeight}),F=Object(u.a)(B,2),z=F[0],D=F[1];Object(s.useEffect)((function(){var e=t.pathname.split("/");return Object(S.o)(e),T(!0),window.addEventListener("resize",U),function(){window.removeEventListener("resize",U)}}),[t.pathname]);var U=function(){var e=R.current.clientHeight,t=R.current.clientWidth;D({width:t,height:e})};return Object(r.jsxs)(r.Fragment,{children:[_&&Object(r.jsx)("div",{className:n.loadingMsg,children:"Loading..."}),Object(r.jsxs)("div",{className:n.root,children:[Object(r.jsxs)(s.Suspense,{fallback:null,children:[Object(r.jsx)(p.a,{}),Object(r.jsx)(P,{mode:c,handleSelect:L.current,open:x,toggleControlOpen:O}),C&&W&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("button",{onClick:g,className:n.openSidebarButton,children:Object(r.jsx)(f.a,{})}),Object(r.jsx)(N,{toggleSidebarOpen:g,open:v,openControl:function(e,t){d(e),L.current=t,O()}})]})]}),C&&Object(r.jsx)("main",{ref:R,className:n.content,children:Object(r.jsx)(E,{setIsLoading:A,viewport:z})})]})]})};n(96);var R="/dl-model";t.a=function(){return Object(r.jsx)(i.c,{children:Object(r.jsx)(o.b,{children:Object(r.jsx)(c.a,{render:function(e){return Object(r.jsx)(W,Object(a.a)({},e))}})})})}},56:function(e,t,n){"use strict";var a=n(13),r=n(1);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(r.useState)(e),n=Object(a.a)(t,2),i=n[0],o=n[1],c=Object(r.useCallback)((function(){o((function(e){return!e}))}),[o]);return[i,c]}},59:function(e,t,n){"use strict";t.a={c110296_02:{x:.043,y:-.0625},c100004_17:{x:.043,y:-.0625},c110371_01:{x:.043,y:-.0625},c110350_02:{x:.043,y:-.0625},c110340_02:{x:.043,y:-.0625},c110018_02:{x:.043,y:-.0625},c110370_01:{x:.043,y:-.0625},c100015_04:{x:.05,y:-.08},c110342_01:{x:0,y:-.02},c110267_01:{x:.08,y:-.03},c110050_02:{x:.07,y:.13},c110291_01:{x:.07,y:.14},c110354_01:{x:.07,y:.01},c110345_01:{x:.08,y:.15},c110266_01:{x:.01,y:.03},c110365_01:{x:.043,y:-.0625},c110346_01:{x:.07,y:.08},c110366_01:{x:.043,y:-.0625},c110299_02:{x:.07,y:.08},c110360_01:{x:.07,y:.14},c110307_01:{x:.08,y:-.03},c110322_01:{x:.043,y:.08},c110356_01:{x:.07,y:.08},c110300_01:{x:.07,y:-.1},c110344_01:{x:.07,y:-.02},c110053_03:{x:.043,y:-.0625},c110368_01:{x:.043,y:-.0625},c110367_01:{x:.043,y:-.0625},c110003_02:{x:.043,y:-.0625},c110270_02:{x:.043,y:-.0625},c110341_03:{x:.043,y:-.0625}}},6:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"A",(function(){return u})),n.d(t,"y",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"B",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"s",(function(){return m})),n.d(t,"v",(function(){return h})),n.d(t,"i",(function(){return b})),n.d(t,"x",(function(){return v})),n.d(t,"z",(function(){return g})),n.d(t,"j",(function(){return j})),n.d(t,"l",(function(){return y})),n.d(t,"h",(function(){return x})),n.d(t,"b",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return k})),n.d(t,"k",(function(){return _})),n.d(t,"C",(function(){return A})),n.d(t,"u",(function(){return M})),n.d(t,"q",(function(){return I})),n.d(t,"a",(function(){return S})),n.d(t,"p",(function(){return C})),n.d(t,"r",(function(){return T})),n.d(t,"t",(function(){return L})),n.d(t,"m",(function(){return E})),n.d(t,"D",(function(){return P}));var a=n(8),r="16rem",i="#330000",o="2",c="https://dgk3593.github.io/dl-model/#/",u={wireframe:{name:"Wireframe",type:"boolean",default:!1},useTexture:{name:"Texture",type:"boolean",default:!0},transparent:{name:"Transparent",type:"boolean",default:!1},flatShading:{name:"Flat Shading",type:"boolean",default:!1},color:{name:"Color",type:"color",default:"#ffffff"},emissive:{name:"Emissive",type:"color",default:"#000000"},opacity:{name:"Opacity",type:"percentage",default:1,min:0,max:1,step:.05},emissiveIntensity:{name:"Emissive Intensity",type:"percentage",default:1,min:0,max:1,step:.05},specular:{name:"Specular",type:"color",default:"#111111"},metalness:{name:"Metalness",type:"percentage",default:0,min:0,max:1,step:.05},roughness:{name:"Roughness",type:"percentage",default:1,min:0,max:1,step:.05},shininess:{name:"Shininess",type:"number",default:30,min:1,max:100,step:1},gradientMap:{name:"Gradient Map",type:"select",default:"none",options:["none","2 Tones","3 Tones","4 Tones","5 Tones"]}},s=["transparent","opacity","wireframe","emissiveIntensity","metalness","roughness","shininess"],l=["color","emissive","specular"],d={};Object.keys(u).forEach((function(e){d[e]=u[e].default}));var f=["gradientMap","flatShading","useTexture"],p=[" .:-=+*#%@"," .'`^\",:;Il!i~+_-?][}{1)(|/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$"],m={model:{materialType:"Basic",id:"c100001_01",texture:"c100001_01",eyeTexture:"c100001_01",eyeIdx:"2",mouthTexture:"c100001_01",mouthIdx:"2",weaponRight:"",weaponLeft:""},materialParams:Object(a.a)({},d),scene:{rotateSpeed:0,background:"#cccccc",initCameraPosition:null,lights:[{lightId:"0",type:"Ambient",color:"#444444",enable:!0,intensity:1},{lightId:"1",type:"Directional",color:"#ffffff",enable:!0,position:[50,0,100],intensity:.8}]},animation:{code:"MWM_CMN+CMN_MWM_03",timeScale:1},app:{sideContent:"settings",showSettings:!0,showAniControl:!0,antiAliasing:!1},outline:{enable:!0,size:5,color:"#000000",opacity:1},capture:{enable:!1,supportedCodecs:[],codec:""},ascii:{enable:!1,charSet:p[1],invert:!1,color:"#00ff00",bgColor:"#000000"}},h={id:{group:"model",key:"id"},et:{group:"model",key:"eyeTexture"},ei:{group:"model",key:"eyeIdx"},mt:{group:"model",key:"mouthTexture"},mi:{group:"model",key:"mouthIdx"},wr:{group:"model",key:"weaponRight"},wl:{group:"model",key:"weaponLeft"},bg:{group:"scene",key:"background"},cam:{group:"scene",key:"initCameraPosition"},ts:{group:"animation",key:"timeScale"},showAC:{group:"app",key:"showAniControl"},showSettings:{group:"app",key:"showSettings"},showOutline:{group:"outline",key:"enable"},AA:{group:"app",key:"antiAliasing"},rot:{group:"scene",key:"rotateSpeed"},cc:{group:"animation",key:"code"}},b=["Basic","Toon","Lambert","Phong","Standard"],v=["transparent","opacity","wireframe","useTexture","color"],g={Basic:[],Toon:["emissive","emissiveIntensity","gradientMap"],Lambert:["emissive","emissiveIntensity"],Phong:["emissive","emissiveIntensity","specular","shininess","flatShading"],Standard:["emissive","emissiveIntensity","metalness","roughness","flatShading"]},j={Sword:"SWD",Blade:"KAT",Dagger:"DAG",Axe:"AXE",Lance:"LAN",Bow:"BOW",Wand:"ROD",Staff:"CAN",Manacaster:"GUN"},y=["Sword","Blade","Dagger","Axe","Lance","Bow","Wand","Staff","Manacaster"],x={Male:21,Female:23},O={Axe:5,Bow:6,Staff:5,Dagger:6,Blade:5,Lance:5,Wand:5,Sword:5},w={Axe:3,Bow:3,Staff:5,Dagger:3,Blade:3,Lance:4,Wand:3,Sword:3},k={rarity:["3","4","5"],element:["Flame","Water","Wind","Light","Shadow"],weapon:["Sword","Blade","Dagger","Axe","Lance","Bow","Wand","Staff","Manacaster"]},_={rarity:["1","2","3","4","5","6"],element:["Flame","Water","Wind","Light","Shadow","None"],weapon:["Sword","Blade","Dagger","Axe","Lance","Bow","Wand","Staff","Manacaster"]},A={c110300_01:"ec110300_01"},M=new Set(["c100007_01","c100007_05","c100007_09","c100034_01","c100036_01","c100037_01","c100041_01"]),I={green:"#00ff00",black:"#000000",grey:"#cccccc",white:"#ffffff"},S={angle:45,far:300,near:.01},C={c:[0,.5,1.5],d:[3,.5,6],w:[2,0,0],b:[1,.5,6],e:[1,1,4],h:[1,.5,3],o:[0,.5,8],r:[3,3,20],c100034_01:[0,.5,1.75],d210078_01:[3,3,20],d210114_01:[3,3,20],h0010001:[6,.5,8],h0010001_02:[2,0,0],h0040101:[1,.5,4],r0070401:[30,30,100],r0080401:[1,2,5],smith:[1,1,2]},T={c:[0,.5,0],d:[0,1,0],w:[0,0,0],b:[0,1,0],e:[0,.5,0],h:[0,1,0],o:[0,0,0],r:[0,3,0],d210078_01:[0,3,0],d210114_01:[0,3,0],h0010001_02:[0,3,0],r0070401:[0,20,0],r0080401:[0,2,0],smith:[0,.5,0]},L={face1:{x:2,y:1},face2:{x:0,y:0},face3:{x:1,y:0},face4:{x:2,y:0},face5:{x:3,y:0},face6:{x:0,y:-1},face7:{x:1,y:-1},face8:{x:2,y:-1},face9:{x:3,y:-1}},E={ts:{key:"timeScale",defaultValue:1},r:{key:"repetitions",defaultValue:1}},P=["video/webm;codecs=h264","video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm"]},70:function(e,t,n){"use strict";var a=n(100),r=n(6),i=n(71),o=r.e,c=r.d,u=Object(a.a)((function(e){return{root:{display:"block",width:"100vw",height:"100vh"},drawer:{width:o,overflowY:"scroll"},drawerPaper:{alignItems:"center",backgroundColor:c,backgroundImage:"url(".concat(i.a,")"),backgroundSize:"cover",backgroundPosition:"center",width:o,"& button":{marginBottom:"0.2rem"}},content:{height:"100vh",width:"100vw",padding:0},openSidebarButton:{position:"absolute",top:0,left:0,margin:"2rem",opacity:"0.5",borderRadius:"0.25rem",transition:"0.5s all ease-in-out",backgroundColor:"#cccccc",cursor:"pointer","&:hover":{opacity:"1"}},loadingMsg:{position:"absolute",zIndex:"9999",width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"x-large",backgroundColor:"rgba(0,0,0,0.5)"}}}));t.a=u},71:function(e,t,n){"use strict";t.a=n.p+"static/media/Rose-Petals.bc11ecc7.svg"},89:function(e,t,n){},9:function(e,t,n){"use strict";n.d(t,"w",(function(){return b})),n.d(t,"m",(function(){return v})),n.d(t,"q",(function(){return j})),n.d(t,"r",(function(){return y})),n.d(t,"b",(function(){return O})),n.d(t,"o",(function(){return w})),n.d(t,"s",(function(){return k})),n.d(t,"v",(function(){return _})),n.d(t,"u",(function(){return A})),n.d(t,"t",(function(){return M})),n.d(t,"k",(function(){return S})),n.d(t,"n",(function(){return C})),n.d(t,"g",(function(){return L})),n.d(t,"i",(function(){return P})),n.d(t,"h",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return B})),n.d(t,"d",(function(){return z})),n.d(t,"f",(function(){return D})),n.d(t,"a",(function(){return U})),n.d(t,"p",(function(){return X})),n.d(t,"j",(function(){return V})),n.d(t,"l",(function(){return H}));var a=n(8),r=n(44),i=n(73),o=n(50),c=n(13),u=n(32),s=n(0),l=n(39),d=n(121),f=n(6),p=n(59),m=n(76),h=n(26),b=function(e){return e&&new Promise((function(t){(new m.a).load(e,t)}))},v=function(){var e=new s.PlaneBufferGeometry(.1,.1);e.rotateX(Math.PI/2);var t=new s.MeshBasicMaterial;return t.visible=!1,new s.Mesh(e,t)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return[];var n=[];return e.traverse((function(e){e.isMesh&&(t||"outline"!==e.name)&&n.unshift(e)})),n},j=function(e){return e?g(e).map((function(e){return e.material})).flat():[]},y=function(e){return"".concat(l.b,"/fbx/").concat(e,"/").concat(e,".fbx")},x=function(e){return"".concat(l.b,"/fbx/").concat(e,"/").concat(e,".png")},O=function(e){if(!e)return"";var t=e.endsWith("b"),n=e.substring(0,e.length-1);return{modelPath:y(n),texturePath:x(n),flipped:t}},w=function(e){if(e){var t=new Set,n=function(e){return e&&function(e){return!t.has(e.uuid)}(e)},a=function(e){n(e)&&function(e){t.add(e.uuid),e.dispose()}(e)};g(e,!0).forEach((function(e){var t;t=e,Object(h.b)(t.material,(function(e){a(e.map),a(e.backupMap),a(e)})),a(e.geometry)}))}},k=function(e){return[].concat(Object(u.a)(f.x),Object(u.a)(f.z[e]))},_=function(e){return!e.startsWith("c")||e.endsWith("_h")||f.u.has(e)},A=function(e){return e.startsWith("d")||"smith"===e},M=function(e){var t=/m[A-Z].*_[0-9]/m;e.traverse((function(e){if(e.isMesh){var n=e.name;t.test(n)&&(e.visible=n.includes("01"))}}))},I=function(e,t){var n="Mesh".concat(e,"Material");return new s[n](t)},S=function(e,t){var n=t.materialType,a=t.texturePath,r=t.forced,i=void 0!==r&&r;e&&g(e).forEach((function(e){var t=[e.material].flat(),r=Array.isArray(e.material);if(!i&&!a){var o="isMesh".concat(n,"Material");if(!t.some((function(e){return!e[o]})))return}t.forEach((function(i,o){var c=a?(new s.TextureLoader).load(a):t[o].map;a&&(c.encoding=s.sRGBEncoding);var u,l,d,f,p=I(n,{map:c,skinning:!0});(p.name=i.name,i.backupMap&&(p.backupMap=i.backupMap),a)&&(null===(u=i.map)||void 0===u||null===(l=u.dispose)||void 0===l||l.call(u),null===(d=i.backupMap)||void 0===d||null===(f=d.dispose)||void 0===f||f.call(d));i.dispose(),r?e.material[o]=p:e.material=p}))}))},C=function(e,t){if(e){var n=[];return g(e).forEach((function(e){var a=e.clone();n.push(a);var r=T(t);E(a,r),a.visible=t.enable,a.name="outline",e.isSkinnedMesh&&a.bind(e.skeleton,e.bindMatrix),e.parent.add(a)})),n}},T=function(e){var t=e.size,n=e.color,a=e.opacity,r={size:{type:"float",value:t},color:{tyle:"vec3",value:new s.Color(n)},opacity:{type:"float",value:a}};return new s.ShaderMaterial({skinning:!0,side:s.BackSide,transparent:!0,uniforms:r,fragmentShader:"#define OUTLINE\nuniform float opacity;\nuniform vec3 color;\nvoid main() {\n\tgl_FragColor = vec4( color, opacity );\n}",vertexShader:"#define OUTLINE\nuniform float size;\nvarying vec3 vViewPosition;\n#include <common>\n#include <color_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t\n    vec3 transformed = position + objectNormal*0.0005*size;\n        \n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n}"})},L=function(e,t){if(e&&t){var n=e.material;t.forEach((function(t,a){switch(a){case"enable":e.visible=t;break;case"color":Object(h.b)(n,(function(e){return e.uniforms.color.value=new s.Color(t)}));break;default:Object(h.b)(n,(function(e){return e.uniforms[a].value=t}))}}))}},E=function(e,t){var n=e.material;Object(h.b)(n,(function(e){var t,n,a,r;null===(t=(n=e.map).dispose)||void 0===t||t.call(n),null===(a=e.backupMap)||void 0===a||null===(r=a.dispose)||void 0===r||r.call(a),e.dispose()}));var a=Array.isArray(e.material);e.material=a?new Array(e.material.length).fill(t):t},P=function(e,t){var n={x:0,y:0};if(e!==t){var a=p.a[t]||{x:0,y:0},r=p.a[e]||{x:0,y:0};n.x=r.x-a.x,n.y=r.y-a.y}return n},N=function(e,t){var n={x:0,y:0};if(e!==t){var a=f.t["face".concat(t)],r=f.t["face".concat(e)];n.x=r.x-a.x,n.y=r.y-a.y}return n},W=function(e){return function(t,n){t.traverse((function(t){if("mBodyAll"===t.name&&3===t.geometry.groups.length){var a=t.geometry.groups.find((function(n){return t.material[n.materialIndex].name==="mt".concat(e,"CH")}));if(a){for(var r=a.start,i=r+a.count,o=t.geometry.attributes.uv,c=r;c<i;c++){var u=o.getX(c)+.25*n.x,s=o.getY(c)+.25*n.y;o.setXY(c,u,s)}o.needsUpdate=!0}}}))}},R=W("Eye"),B=W("Mouth"),F=function(e){return function(t,n){var a=n.materialType,r=n.textureId,i=x(r),o=(new s.TextureLoader).load(i);o.encoding=s.sRGBEncoding;var c=I(a,{map:o,skinning:!0});t.traverse((function(t){if("mBodyAll"===t.name&&3===t.geometry.groups.length){var n=t.geometry.groups.find((function(n){return t.material[n.materialIndex].name==="mt".concat(e,"CH")}));if(n){var a=n.materialIndex;c.name=t.material[a].name,t.material[a]=c}}}))}},z=F("Eye"),D=F("Mouth"),U=function(e){if(!e)return["",""];for(var t=e.split(">"),n=t.length,a=[],r=[],u=0;u<n;u++){var s,l=1,d=1,f=null,p=null,m=null,h=void 0,b=[],v=t[u].split("+");if(1===v.length)h=v[0];else{var g=Object(c.a)(v,2);m=g[0],h=g[1],f=a.length-1}if(m&&(f=a.length,a.push(m)),h.includes("&")){var j=h.split("&"),y=Object(o.a)(j),x=y[0],O=y.slice(1);p=x;var w,k=Object(i.a)(O);try{for(k.s();!(w=k.n()).done;){var _=w.value.split("="),A=Object(c.a)(_,2),M=A[0],I=A[1];if("ts"===M&&(l=parseFloat(I)),"r"===M&&(d="inf"===I?1/0:parseInt(I)),M.includes("-")){var S=M.split("-"),C=Object(c.a)(S,2),T=C[0],L=C[1],E={time:parseFloat(L)};E["".concat("e"===T?"eye":"mouth","Idx")]=I,b.push(E)}}}catch(P){k.e(P)}finally{k.f()}}else p=h;s={fileIdx:f,aniName:p,timeScale:l,repetitions:d,faceChanges:G(b)},r.push(s)}return[a,r]},G=function(e){if(!e.length)return e;var t=e.sort((function(e){return e.time})),n=new Set(e.map((function(e){return e.time})));if(e.length===n.size)return t.forEach((function(e){e.id=Object(d.a)()})),t;var a=[];return n.forEach((function(e){var n={time:e,id:Object(d.a)(),eyeIdx:"",mouthIdx:""};t.filter((function(t){return t.time===e})).forEach((function(e){return n=Object.assign(n,e)})),a.push(n)})),a},X=function(e,t){if(!e)return[];if(1===t)return Object(u.a)(e);return new Array(t).fill().map((function(e,t){return 100*t})).map((function(t){return e.map((function(e){var n=e.time,i=(e.id,Object(r.a)(e,["time","id"]));return Object(a.a)(Object(a.a)({},i),{},{time:n+t})}))})).flat()},V=function(e,t){var n=U(e),a=Object(c.a)(n,2),r=a[0],i=a[1],o=i.length;return i.map((function(e,n){var a=e.fileIdx,i=e.aniName,c=e.timeScale,u=e.repetitions,s=e.faceChanges;return{name:t.concat(o>1?"#".concat(n+1):""),fileName:r[a],aniName:i,timeScale:c,repetitions:u,faceChanges:s,id:Object(d.a)()}}))},H=function(e){var t=new Uint8Array(e).map((function(t,n){return 256*n/e})),n=new s.DataTexture(t,e,1,s.LuminanceFormat);return n.minFilter=s.NearestFilter,n.magFilter=s.NearestFilter,n.generateMipmaps=!1,n}},94:function(e,t,n){},96:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var a=n(11),r=n(35),i=n.n(r),o=(n(89),n(39)),c=n(54);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(a.jsx)(c.a,{children:Object(a.jsx)(o.a,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[98,9,11]]]);
//# sourceMappingURL=main.d338ff36.chunk.js.map