{"version":3,"sources":["helpers/downloadBlob.js","helpers/exportModel/exportOptions.js","helpers/exportModel/exportModel.js"],"names":["downloadBlob","blob","fileName","url","URL","createObjectURL","a","document","createElement","style","display","href","download","body","appendChild","click","window","revokeObjectURL","removeChild","exportOptions","format","name","options","exporters","stl","gltf","usdz","ply","cloneModel","model","output","clone","traverse","child","parent","remove","exportModel","settings","optionList","find","option","filterObject","model2stl","STLExporter","exporter","parse","fileContent","Blob","type","model2gltf","GLTFExporter","Promise","resolve","binary","JSON","stringify","model2usdz","USDZExporter","model2ply","PLYExporter"],"mappings":"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","file":"static/js/51.bb56b2d5.chunk.js","sourcesContent":["/**\r\n * download a blob as the given file name\r\n * @param {Blob} blob\r\n * @param {string} fileName\r\n */\r\nexport default function downloadBlob(blob, fileName) {\r\n    const url = URL.createObjectURL(blob);\r\n\r\n    const a = document.createElement(\"a\");\r\n    a.style.display = \"none\";\r\n    a.href = url;\r\n    a.download = fileName;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n\r\n    window.URL.revokeObjectURL(url);\r\n    document.body.removeChild(a);\r\n}\r\n","/**\r\n * @typedef {Object} ExportType\r\n * @property {string} format\r\n * @property {string} name\r\n * @property {string[]} options\r\n */\r\n/**\r\n * @type {ExportType[]}\r\n */\r\nconst exportOptions = [\r\n    { format: \"stl\", name: \"STL\", options: [\"binary\"] },\r\n    { format: \"ply\", name: \"PLY\", options: [\"binary\"] },\r\n    // { format: \"gltf\", name: \"glTF\", options: [\"binary\"] },\r\n    // { format: \"usdz\", name: \"USDZ\", options: [] },\r\n];\r\nexport default exportOptions;\r\n","import downloadBlob from \"../downloadBlob\";\r\nimport { filterObject } from \"../helpers\";\r\nimport exportOptions from \"./exportOptions\";\r\n\r\nconst exporters = {\r\n    stl: exportSTL,\r\n    gltf: exportGLTF,\r\n    usdz: exportUSDZ,\r\n    ply: exportPLY,\r\n};\r\n\r\n/**\r\n * create a copy of the model without outlines\r\n * @param {THREE.Object3D} model\r\n */\r\nconst cloneModel = model => {\r\n    const output = model.clone(true);\r\n\r\n    output.traverse(child => {\r\n        if (child.name === \"outline\") child.parent.remove(child);\r\n    });\r\n\r\n    return output;\r\n};\r\n\r\n/**\r\n * export 3d model\r\n * @param {THREE.Object3D} model\r\n * @param {AppExportState} settings\r\n */\r\nexport async function exportModel(model, settings) {\r\n    const clone = cloneModel(model);\r\n    const { format } = settings;\r\n    const optionList = exportOptions.find(option => option.format === format)\r\n        .options;\r\n\r\n    const options = filterObject(settings, optionList);\r\n\r\n    exporters[format](clone, options);\r\n}\r\n\r\n/**\r\n * convert model to stl data\r\n * @param {THREE.Object3D} model\r\n * @param {Object} options\r\n */\r\nasync function model2stl(model, options) {\r\n    const { STLExporter } = await import(\r\n        \"three/examples/jsm/exporters/STLExporter\"\r\n    );\r\n    const exporter = new STLExporter();\r\n\r\n    return exporter.parse(model, options);\r\n}\r\n\r\n/**\r\n * ! NEEDS SMOOTHING\r\n */\r\n/**\r\n * export model to stl\r\n * @param {THREE.Object3D} model\r\n * @param {Object} options\r\n */\r\nasync function exportSTL(model, options) {\r\n    const fileContent = await model2stl(model, options);\r\n    const blob = new Blob([fileContent], { type: \"text/plain\" });\r\n    const fileName = \"model.stl\";\r\n\r\n    downloadBlob(blob, fileName);\r\n}\r\n\r\n/**\r\n * convert model to glTF data\r\n * @param {THREE.Object3D} model\r\n * @param {{ }} options\r\n */\r\nasync function model2gltf(model, options) {\r\n    const { GLTFExporter } = await import(\r\n        \"three/examples/jsm/exporters/GLTFExporter\"\r\n    );\r\n    const exporter = new GLTFExporter();\r\n\r\n    return new Promise(resolve => exporter.parse(model, resolve, options));\r\n}\r\n\r\n/**\r\n * ! NOT WORKING\r\n */\r\n/**\r\n * export model to glTF\r\n * @param {THREE.Object3D} model\r\n * @param {Object} options\r\n */\r\nasync function exportGLTF(model, options) {\r\n    const fileContent = await model2gltf(model, options);\r\n\r\n    const { binary } = options;\r\n    const blob = binary\r\n        ? new Blob([fileContent], { type: \"application/octet-stream\" })\r\n        : new Blob([JSON.stringify(fileContent)], { type: \"text/plain\" });\r\n\r\n    const ext = binary ? \"glb\" : \"gltf\";\r\n    const fileName = `model.${ext}`;\r\n\r\n    downloadBlob(blob, fileName);\r\n}\r\n\r\n/**\r\n * convert a model to USDZ\r\n * @param {THREE.Object3D} model\r\n */\r\nasync function model2usdz(model) {\r\n    const { USDZExporter } = await import(\r\n        \"three/examples/jsm/exporters/USDZExporter\"\r\n    );\r\n    const exporter = new USDZExporter();\r\n    return exporter.parse(model);\r\n}\r\n\r\n/**\r\n * ! NOT WORKING\r\n */\r\n/**\r\n * Export a model to USDZ\r\n * @param {THREE.Object3D} model\r\n */\r\nasync function exportUSDZ(model) {\r\n    const fileContent = await model2usdz(model);\r\n\r\n    const blob = new Blob([fileContent], { type: \"application/octet-stream\" });\r\n    const fileName = \"model.usdz\";\r\n\r\n    downloadBlob(blob, fileName);\r\n}\r\n\r\n/**\r\n * convert model to ply data\r\n * @param {THREE.Object3D} model\r\n * @param {Object} options\r\n */\r\nasync function model2ply(model, options) {\r\n    const { PLYExporter } = await import(\r\n        \"three/examples/jsm/exporters/PLYExporter\"\r\n    );\r\n    const exporter = new PLYExporter();\r\n\r\n    return new Promise(resolve => exporter.parse(model, resolve, options));\r\n}\r\n\r\n/**\r\n * ! NOT WORKING\r\n */\r\n/**\r\n * export model to stl\r\n * @param {THREE.Object3D} model\r\n * @param {Object} options\r\n */\r\nasync function exportPLY(model, options) {\r\n    const fileContent = await model2ply(model, options);\r\n\r\n    const { binary } = options;\r\n    const blob = binary\r\n        ? new Blob([fileContent], { type: \"application/octet-stream\" })\r\n        : new Blob([fileContent], { type: \"text/plain\" });\r\n    const fileName = \"model.ply\";\r\n\r\n    downloadBlob(blob, fileName);\r\n}\r\n"],"sourceRoot":""}