(this["webpackJsonpdl-model"]=this["webpackJsonpdl-model"]||[]).push([[18],{493:function(t,e,n){"use strict";n.r(e),n.d(e,"PLYExporter",(function(){return a}));var r=n(0),o=n(2),i=n(5),a=function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,[{key:"parse",value:function(t,e,n){function r(e){t.traverse((function(t){if(!0===t.isMesh){var n=t,r=n.geometry;if(!0!==r.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");!0===r.hasAttribute("position")&&e(n,r)}}))}e&&"object"===typeof e&&(console.warn('THREE.PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),n=e,e=void 0);var o=(n=Object.assign({binary:!1,excludeAttributes:[],littleEndian:!1},n)).excludeAttributes,a=!1,l=!1,u=!1,c=0,s=0;t.traverse((function(t){if(!0===t.isMesh){var e=t.geometry;if(!0!==e.isBufferGeometry)throw new Error("THREE.PLYExporter: Geometry is not of type THREE.BufferGeometry.");var n=e.getAttribute("position"),r=e.getAttribute("normal"),o=e.getAttribute("uv"),i=e.getAttribute("color"),f=e.getIndex();if(void 0===n)return;c+=n.count,s+=f?f.count/3:n.count/3,void 0!==r&&(a=!0),void 0!==o&&(u=!0),void 0!==i&&(l=!0)}}));var f=-1===o.indexOf("index");if(a=a&&-1===o.indexOf("normal"),l=l&&-1===o.indexOf("color"),u=u&&-1===o.indexOf("uv"),f&&s!==Math.floor(s))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var d="ply\n"+"format ".concat(n.binary?n.littleEndian?"binary_little_endian":"binary_big_endian":"ascii"," 1.0\n")+"element vertex ".concat(c,"\n")+"property float x\nproperty float y\nproperty float z\n";!0===a&&(d+="property float nx\nproperty float ny\nproperty float nz\n"),!0===u&&(d+="property float s\nproperty float t\n"),!0===l&&(d+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===f&&(d+="element face ".concat(s,"\n")+"property list uchar int vertex_index\n"),d+="end_header\n";var g=new i.Vector3,p=new i.Matrix3,y=null;if(!0===n.binary){var x=(new TextEncoder).encode(d),E=c*(12+(a?12:0)+(l?3:0)+(u?8:0)),v=f?13*s:0,b=new DataView(new ArrayBuffer(x.length+E+v));new Uint8Array(b.buffer).set(x,0);var h=x.length,m=x.length+E,A=0;r((function(t,e){var r=e.getAttribute("position"),o=e.getAttribute("normal"),i=e.getAttribute("uv"),c=e.getAttribute("color"),s=e.getIndex();p.getNormalMatrix(t.matrixWorld);for(var d=0,y=r.count;d<y;d++)g.x=r.getX(d),g.y=r.getY(d),g.z=r.getZ(d),g.applyMatrix4(t.matrixWorld),b.setFloat32(h,g.x,n.littleEndian),h+=4,b.setFloat32(h,g.y,n.littleEndian),h+=4,b.setFloat32(h,g.z,n.littleEndian),h+=4,!0===a&&(null!=o?(g.x=o.getX(d),g.y=o.getY(d),g.z=o.getZ(d),g.applyMatrix3(p).normalize(),b.setFloat32(h,g.x,n.littleEndian),h+=4,b.setFloat32(h,g.y,n.littleEndian),h+=4,b.setFloat32(h,g.z,n.littleEndian),h+=4):(b.setFloat32(h,0,n.littleEndian),h+=4,b.setFloat32(h,0,n.littleEndian),h+=4,b.setFloat32(h,0,n.littleEndian),h+=4)),!0===u&&(null!=i?(b.setFloat32(h,i.getX(d),n.littleEndian),h+=4,b.setFloat32(h,i.getY(d),n.littleEndian),h+=4):!1!==u&&(b.setFloat32(h,0,n.littleEndian),h+=4,b.setFloat32(h,0,n.littleEndian),h+=4)),!0===l&&(null!=c?(b.setUint8(h,Math.floor(255*c.getX(d))),h+=1,b.setUint8(h,Math.floor(255*c.getY(d))),h+=1,b.setUint8(h,Math.floor(255*c.getZ(d))),h+=1):(b.setUint8(h,255),h+=1,b.setUint8(h,255),h+=1,b.setUint8(h,255),h+=1));if(!0===f)if(null!==s)for(var x=0,E=s.count;x<E;x+=3)b.setUint8(m,3),m+=1,b.setUint32(m,s.getX(x+0)+A,n.littleEndian),m+=4,b.setUint32(m,s.getX(x+1)+A,n.littleEndian),m+=4,b.setUint32(m,s.getX(x+2)+A,n.littleEndian),m+=4;else for(var v=0,w=r.count;v<w;v+=3)b.setUint8(m,3),m+=1,b.setUint32(m,A+v,n.littleEndian),m+=4,b.setUint32(m,A+v+1,n.littleEndian),m+=4,b.setUint32(m,A+v+2,n.littleEndian),m+=4;A+=r.count})),y=b.buffer}else{var w=0,M="",F="";r((function(t,e){var n=e.getAttribute("position"),r=e.getAttribute("normal"),o=e.getAttribute("uv"),i=e.getAttribute("color"),c=e.getIndex();p.getNormalMatrix(t.matrixWorld);for(var d=0,y=n.count;d<y;d++){g.x=n.getX(d),g.y=n.getY(d),g.z=n.getZ(d),g.applyMatrix4(t.matrixWorld);var x=g.x+" "+g.y+" "+g.z;!0===a&&(null!=r?(g.x=r.getX(d),g.y=r.getY(d),g.z=r.getZ(d),g.applyMatrix3(p).normalize(),x+=" "+g.x+" "+g.y+" "+g.z):x+=" 0 0 0"),!0===u&&(null!=o?x+=" "+o.getX(d)+" "+o.getY(d):!1!==u&&(x+=" 0 0")),!0===l&&(x+=null!=i?" "+Math.floor(255*i.getX(d))+" "+Math.floor(255*i.getY(d))+" "+Math.floor(255*i.getZ(d)):" 255 255 255"),M+=x+"\n"}if(!0===f){if(null!==c)for(var E=0,v=c.count;E<v;E+=3)F+="3 ".concat(c.getX(E+0)+w),F+=" ".concat(c.getX(E+1)+w),F+=" ".concat(c.getX(E+2)+w,"\n");else for(var b=0,h=n.count;b<h;b+=3)F+="3 ".concat(w+b," ").concat(w+b+1," ").concat(w+b+2,"\n");s+=c?c.count/3:n.count/3}w+=n.count})),y="".concat(d).concat(M).concat(f?"".concat(F,"\n"):"\n")}return"function"===typeof e&&requestAnimationFrame((function(){return e(y)})),y}}]),t}()}}]);
//# sourceMappingURL=PLYExporter.8b85f7c1.chunk.js.map